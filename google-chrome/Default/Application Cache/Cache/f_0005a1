d0e.prototype.Uqa=W(1459,function(){return[]});d0e.prototype.Jqa=W(1458,ea("Answers feedback"));GW.prototype.BK=W(1457,ea(10));ZW.prototype.BK=W(1456,g("Pa"));aX.prototype.BK=W(1455,g("D"));J5e.prototype.BK=W(1454,ea(10));YTe.prototype.mca=W(1453,ea(null));d0e.prototype.mca=W(1452,g("F"));function sMf(a,b){D(a,1,b)}function tMf(a){var b=Na();L(a,3,b)}
function uMf(a,b,c){var d=Nj(a.C,AT,1),e=new AT;L(e,1,b);L(e,2,c);L(e,4,0);tMf(e);d.push(e);pd(d,function(f,h){return(h.Wi()||0)-(f.Wi()||0)});md(d,void 0,function(f){return K(f,1)+", "+f.gb()});Qj(a.C,1,ld(d,0,a.O));sie(a)}function vMf(a){return a.F["ritz-DataPrepSuggestionsSidepaneCount"]}
function wMf(a){var b=a.Xf,c=a.tha,d=a.wha,e=a.uha,f=a.lZ;a='<div class="'+U("waffle-assistant-popup-suggestion-text")+'">';b='Data cleanup suggestions available for <span class="'+(U("waffle-inline-assistant-rec-range")+'">'+(R(b)+"</span>"));a=a+b+"<ul>";0<f&&(a+="<li>",b=CT(new wB("{NUM_ANOMALIES_1,plural,=1{{START_BOLD}{NUM_ANOMALIES_2}{END_BOLD} anomaly}other{{START_BOLD}{NUM_ANOMALIES_2}{END_BOLD} anomalies}}"),{NUM_ANOMALIES_1:f,START_BOLD:"<b>",NUM_ANOMALIES_2:R(f),END_BOLD:"</b>"}),a=a+b+
"</li>");0<e&&(a+="<li>",e=CT(new wB("{NUM_REMOVE_DUPLICATE_SUGGESTIONS_1,plural,=1{{START_BOLD}{NUM_REMOVE_DUPLICATE_SUGGESTIONS_2}{END_BOLD} duplicate row}other{{START_BOLD}{NUM_REMOVE_DUPLICATE_SUGGESTIONS_2}{END_BOLD} duplicate rows}}"),{NUM_REMOVE_DUPLICATE_SUGGESTIONS_1:e,START_BOLD:"<b>",NUM_REMOVE_DUPLICATE_SUGGESTIONS_2:R(e),END_BOLD:"</b>"}),a+=e,a+="</li>");0<c&&(a+="<li>",c=CT(new wB("{NUM_NF_SUGGESTIONS_1,plural,=1{{START_BOLD}{NUM_NF_SUGGESTIONS_2}{END_BOLD} column format suggestion}other{{START_BOLD}{NUM_NF_SUGGESTIONS_2}{END_BOLD} column format suggestions}}"),
{NUM_NF_SUGGESTIONS_1:c,START_BOLD:"<b>",NUM_NF_SUGGESTIONS_2:R(c),END_BOLD:"</b>"}),a+=c,a+="</li>");0<d&&(a+="<li>",d=CT(new wB("{NUM_TRIM_WS_SUGGESTIONS_1,plural,=1{{START_BOLD}{NUM_TRIM_WS_SUGGESTIONS_2}{END_BOLD} range with excess whitespace}other{{START_BOLD}{NUM_TRIM_WS_SUGGESTIONS_2}{END_BOLD} ranges with excess whitespace}}"),{NUM_TRIM_WS_SUGGESTIONS_1:d,START_BOLD:"<b>",NUM_TRIM_WS_SUGGESTIONS_2:R(d),END_BOLD:"</b>"}),a+=d,a+="</li>");a+="</ul></div>";return T(a)}
function xMf(a){var b=a.Xf,c=a.kYa;a='<div class="'+U("waffle-assistant-popup-suggestion-text")+'">';b=R(c)+(' data cleanup suggestions available for <span class="'+(U("waffle-inline-assistant-rec-range")+'">'+(R(b)+"</span>")));return T(a+b+"</div>")}
function yMf(a,b,c){b=c||b;c=a.Xf;var d=a.tha,e=a.wha,f=a.uha,h=a.lZ;a=a.Rdc;var k='<div class="'+U("waffle-assistant-floating-popup")+'"><div class="'+U("waffle-assistant-popup-logo")+'" aria-label="';k+=Fx("Data cleanup suggestions");k+='">'+R(gC({icon:"docs-icon-img docs-icon-explore-green"},b))+'</div><div class="'+U("waffle-assistant-popup-suggestion-text-container")+'">'+(a?wMf({Xf:c,tha:d,wha:e,uha:f,lZ:h},b):xMf({Xf:c,kYa:d+e+f+h},b))+'</div><div class="'+U("waffle-assistant-popup-button-row")+
'">';k+=R(OA({dd:"waffle-assistant-popup-button waffle-assistant-popup-button-dismiss",content:"Dismiss",id:"waffle-assistant-popup-button-dismiss",style:0},b));k+=R(OA({dd:"waffle-assistant-popup-button waffle-assistant-popup-button-review",content:"Review",id:"waffle-assistant-popup-button-review",style:2},b));return T(k+"</div></div>")}
function zMf(a,b){a.D=0;a.F=0;a.C=0;b=ja(b);for(var c=b.next();!c.done;c=b.next())switch(c=c.value,C(c,1)){case 7:a.D++;break;case 8:a.F++;break;case 9:c=C(c,16),c=Pg(c,5),a.C+=c.length}}function AMf(a){var b=new rk;for(d in a4b){var c=new mT;switch(a4b[d]){case 7:L(c,1,1);L(c,2,a.D);break;case 8:L(c,1,2);L(c,2,a.F);break;case 9:L(c,1,4);L(c,2,a.C);break;default:continue}Rj(b,25,c,mT,void 0)}var d=new mT;L(d,1,3);L(d,2,a.H);Rj(b,25,d,mT,void 0);return Dz(Cz(yz(new xz,76),b))}
function BMf(a,b,c,d,e,f){Q.call(this,f);var h=this;this.ma=a;this.J=c;this.C=this.F=this.D=-1;zMf(this,d);this.H=e;this.L=sC(new rC);this.qa(this.L);this.R=new Hz(void 0,Fz.getInstance(),this.oa());this.Fa(this.R);KA(this.L,this.R,qsb,void 0,void 0,function(){return AMf(h)});this.O=new Hz(void 0,Fz.getInstance(),this.oa());this.Fa(this.O);KA(this.L,this.O,psb,void 0,void 0,function(){return AMf(h)});this.V=new bW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");
this.qa(this.V)}t(BMf,Q);m=BMf.prototype;m.Aa=function(){var a=IM(this.J.rect);a=Ty(yMf,{Xf:a,tha:this.D,wha:this.F,uha:this.C,lZ:this.H,Rdc:z(y(),"feadpdp")});this.jb(a)};m.Ga=function(){Q.prototype.Ga.call(this);this.R.Va(this.Ea("waffle-assistant-popup-button-review"));this.O.Va(this.Ea("waffle-assistant-popup-button-dismiss"));var a=this.Ka();this.getHandler().listen(a,"mouseenter",this.F4b).listen(a,"mouseleave",this.G4b);a={};AB(this.ma,(a.Mc=!0,a));QJ("Assistant suggestion popup shown.")};
m.Ia=function(){Q.prototype.Ia.call(this);var a={};AB(this.ma,(a.Mc=!1,a));QJ("Assistant suggestion popup hidden.")};m.F4b=function(){dW(this.V,this.J)};m.G4b=function(){aW(this.V)};function CMf(a,b,c,d,e,f){if(a.fc&&!a.fc.isDisposed())return a.fc;var h=Gp(a.oa(),a.Ja.gb()+"-grid-table-container");a.fc=new BMf(c,b,d,e,f,a.fb);a.Fa(a.fc);a.fc.render(h);return a.fc}function DMf(a){Rn.call(this,a)}t(DMf,Rn);DMf.prototype.hasType=function(){return this.message.hasType()};DMf.prototype.getType=function(){return this.message.getType()};
DMf.prototype.setType=function(a){return Xn(this,1,a)};DMf.prototype.clearType=function(){return Tn(this,1)};function EMf(a){this.Id=Dn(a,-1,0)}t(EMf,Hn);EMf.prototype.mf=function(){return new DMf(this)};EMf.prototype.hasType=function(){return Kn(this,1)};EMf.prototype.getType=function(){return On(this,1,0)};function FMf(a,b,c){RJ.call(this,156);this.hb=a;this.F=b;this.C=c}t(FMf,RJ);
FMf.prototype.Kd=function(){var a=new ARb;this.C.forEach(function(b){var c=C(b,1),d=new Fr;b=b.getValue();D(d,3,b);b=new Gr;var e=c.Fj();D(b,1,e);c=c.getColumnIndex();D(b,2,c);D(b,3,d);Ng(a,2,b)});sMf(a,fo(this.F,this.hb.$b()));return a};FMf.prototype.Cg=ea(!1);
function GMf(a,b){var c=a.D.qb(b);return new Qp(function(d,e){Hl(Il(Pq(Gl(Zq($q(a.C.We("/smartFill/getSuggestion"),"POST")),1).setTimeout(3E4),["data",Hm(c)]),function(f){var h=a.D.Od(FS.getDescriptor(),f.Me());1!=h.getStatus()&&e(f);d(h)}),function(){var f=new FS;D(f,1,2);e(f)}).Pe()})}function HMf(a,b,c){this.C=a;this.D=b;this.F=c}HMf.prototype.Bj=g("D");HMf.prototype.Jd=g("F");function IMf(a,b,c,d,e){var f=b.rect;if(f){b=b.C;var h=a.C[b];h||(h={},a.C[b]=h);h[f.left+f.width-1]=new HMf(c,d,e)}}
function JMf(a){var b=WCd.getInstance(),c=a.rect;return c?(a=b.C[a.C])?a[c.left+c.width-1]||null:null:null}function KMf(a){var b=WCd.getInstance(),c=a.rect;c&&(a=b.C[a.C])&&Wd(a,c.left+c.width-1)}function LMf(a){var b=a.D.C,c=b.C;return Kpc(a.D)?AI(b,a.D.Na):c}function MMf(a){return(a=VJ(a.C))?a.H:null}function NMf(a,b){return 0>b.x||0>b.y?null:WI(SI(a,b),a.$b(),b.y,b.x)}
function p_(a,b,c,d){var e=yz(new xz,22);c&&(c=1E3*((new Date).getTime()-c),c=nk(new mk,c),Az(yz(e,41),c));d&&(c=new rk,d=L(c,30,d),Cz(e,d));a.V.C(b,Dz(e))}
function OMf(a,b,c){if(z(y(),"femfs")&&(b=ritz_api.RitzModelApi.getSmartFillSuggestionRequest(b,c.y,c.x,10,10),b=a.F.Od(SCd.getDescriptor(),b),Kg(b,1))){var d=(new Date).getTime();GMf(a.PBa,b).then(function(e){p_(a,36766,d);var f=C(e,4),h=C(e,2),k=Pg(e,5);k&&0<k.length?(e=WCd.getInstance(),h=go(h),IMf(e,h,f,null,k)):e.Bj()&&(k=WCd.getInstance(),h=go(h),e=e.Bj(),IMf(k,h,f,e,null))},function(){p_(a,36767,d)})}}
function PMf(a,b){var c=ritz_api.TablesApi.getCurrentlyDetectedTables(MG(a,b).qb());b=a.tc();0<c.length&&(c=c[0].getDimensionTableAccessor(),0==c.getDimensionTagName()&&(c=c.getHeaderRange(),c=ritz_api.RitzModelApi.toSerializedGridRangeProto(c),c=OG(ao(c)),c.tc()<=b&&c.Vc()>=b&&(b=a.tc()+c.Vc()-c.tc())));return new dn(b,a.Wc()-1,a.Vc(),a.Wc())}function QMf(a){return(a=MMf(a))?a.Na:null}
function RMf(a,b){b=void 0===b?!1:b;var c=VJ(a.C);c&&(ritz_api.GridViewApi.removeSmartFillSuggestion(c.O.V),(a=QMf(a))&&a.Ke(),b&&c.Qc())}
function SMf(a,b,c,d,e,f,h,k){A.call(this);this.D=a;this.C=b;this.V=c;this.Xa=d;this.PBa=VCd.getInstance();this.F=new vl;this.O=f;this.R=h;this.Ua=new Po(this);this.qa(this.Ua);this.H=new GA(this);this.qa(this.H);this.Ua.listen(this.C,"inputBoxDeactivate",this.xa).listen(this.C,"inputBoxActivate",this.ma);z(y(),"femfs")&&k.C(FAb,YCd).D(FAb,YCd).C(GAb,YCd).D(GAb,YCd);z(y(),"femfs")&&this.H.subscribe(FAb,"action",this.J).subscribe(GAb,"action",this.L)}t(SMf,A);
SMf.prototype.xa=function(a){var b,c=(new Date).getTime();if(a.ma){var d=LMf(this);if(d){var e=MMf(this);if(e&&!e.H.L&&(RMf(this,!0),(a=AO(e))&&a.getValue()&&a.Tc!=a.getValue()&&!nF(a.getValue())&&(e=(a=d.Hc())&&qI(a,AO(e).ys))&&0!=e.x&&(d=new Cn(d.gb(),fn(e)),!JMf(d)))){a:{for(d=1;10>=d;d++)if(NMf(a,new Km(e.x,e.y+d))){d=!1;break a}d=!0}if(d){var f=b=0;var h=Math.max(0,e.x-10);d=0;for(var k=h;k<e.x;k++){for(var l=0,n=0;10>n;n++){var q=NMf(a,new Km(k,e.y+n));q?nF(q)?f++:b++:5<=n&&l++}5<=l&&d++}h=
e.x-h;d>=h?(p_(this,36757,c),c=!1):.6<b/(10*h)?(p_(this,36754,c),c=!0):(.6<f/(10*h)?p_(this,36755,c):p_(this,36756,c),c=!1);c&&OMf(this,a.$b(),e)}}}}};
SMf.prototype.ma=function(){var a=this,b=LMf(this),c=VJ(this.C);if(b&&c){var d=MMf(this);if(d&&!d.H.L&&AO(d)){var e=b.Hc(),f=e&&qI(e,AO(d).ys);if(f){var h=fn(f),k=new Cn(b.gb(),fn(f));if(f=JMf(k))if(h=Che(e,h,["N","S","W"]),e=PMf(h,e.$b()),e=new Cn(b.gb(),e),b=(new Date).getTime(),f.Bj()?(h=f.Bj(),e=this.O.getCalculatedSmartFillSuggestion(AV(e).qb(),h.startsWith("=")?h:"="+h)):e=ritz_api.GridViewApi.getSmartFillSuggestionForValues(f.Jd().map(function(l){return a.F.qb(l)})),e){if(k=QMf(this))k.D=d.O,
k.D.xa?k.F=null:k.F=k.D==d.C?d.L:null,cOc(k,!0);ritz_api.GridViewApi.updateSmartFillModel(c.O.V,e);c.Qc();p_(this,36773,b,f.C)}else RMf(this),KMf(k);else RMf(this,!0)}}}};SMf.prototype.J=function(){var a=this,b=LMf(this),c=b.Hc(),d=c.F,e=new Cn(b.gb(),d);if(b=JMf(e)){p_(this,36777,void 0,b.C);d=Che(c,d,["N","S","W"]);d=PMf(d,c.$b());var f=MMf(this);f&&f.C.Ke(!1);var h;b.Jd()?h=new FMf(c,d,b.Jd()):h=new ztd(c,d,b.Bj());SJ(h,function(k){k&&(RMf(a,!0),KMf(e))});this.R.C(h)}};
SMf.prototype.L=function(){var a=LMf(this),b=a.Hc().F;a=new Cn(a.gb(),b);if(b=JMf(a))p_(this,36778,void 0,b.C),RMf(this,!0),KMf(a)};function TMf(a,b){var c=Kn(a,1)?bo(a):Number.MIN_VALUE;a=Kn(a,2)?Nn(a,2):Number.MAX_VALUE;var d=Kn(b,1)?bo(b):Number.MIN_VALUE;b=Kn(b,2)?Nn(b,2):Number.MAX_VALUE;return b>c&&a>d||c==d&&a==b}function UMf(a){return Sn(aCa(ZBa(),a))}
function VMf(){var a='<div style="float:right;"><div class="'+U("waffle-inline-assistant-ignore-button")+'">';return T(a+"Ignore</div></div>")}
function WMf(a,b,c){b=c||b;c=a.column;var d=a.D$b,e=a.C$b,f=a.YOb;a=a.wMb;var h='<div style="outline: none;margin-bottom: 12px;"><div class="'+U("waffle-assistant-card-feedback")+'"></div>';f?(h+='<div class="'+U("waffle-inline-assistant-nf-suggestion-description")+'">',h+="Numbers in this column are text</div>"):a&&(h+='<div class="'+U("waffle-inline-assistant-nf-suggestion-description")+'">',h+="There are multiple formats in this column</div>");h+='<div class="'+U("waffle-inline-assistant-recommendation-container")+
'"><div class="'+U("waffle-inline-assistant-gridrange-chip")+'">'+R(c)+'<div class="'+U("waffle-assistant-input-reject-icon")+'" style="display:none">'+R(gC({icon:"docs-icon-img docs-icon-close"},b))+'</div></div><div class="'+U("waffle-inline-assistant-suggestion-row")+'">';f?(h+='<div class="'+U("waffle-inline-assistant-nf-row")+'"><div class="'+U("waffle-inline-assistant-nf-suggested-preview")+" "+U("waffle-inline-assistant-nf-suggestion-text")+'">',h+="Convert to numbers</div></div>"):h+='<div class="'+
U("waffle-inline-assistant-nf-row")+'">'+(a?"":'<div class="'+U("waffle-inline-assistant-nf-original-preview")+" "+U("waffle-inline-assistant-nf-suggestion-text")+'">'+R(d)+"</div>")+'<div class="'+U("waffle-inline-assistant-nf-suggested-preview")+" "+U("waffle-inline-assistant-nf-suggestion-text")+'">'+R(e)+"</div></div>";h+='</div><div class="'+U("waffle-inline-assistant-nf-check")+'">'+R(gC({icon:"docs-icon-img docs-icon-check"},b))+"</div></div></div>";return T(h)}
function XMf(a){var b=a.Xf;xa(a.sna);a=a.sna;b='<div style="outline: none"><div class="'+U("waffle-assistant-card-feedback")+'"></div><div class="'+U("waffle-inline-assistant-recommendation-container")+'"><div class="'+U("waffle-inline-assistant-gridrange-chip")+'">'+R(b)+'</div><div class="'+U("waffle-inline-assistant-suggestion-row")+'"><div class="'+U("waffle-inline-assistant-tw-row")+'">';for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=Bx(e,null)?'<div class="'+U("waffle-inline-assistant-tw-space")+
'"></div>':R(e)}return T(b+"</div></div></div></div>")}function YMf(a,b){a=a.jYa;b='<div class="'+U("waffle-inline-assistant-suggestion-row-overflow-button docs-material")+'">'+R(gC({icon:"docs-icon-img docs-icon-chevron-down-24"},b));a="See "+(R(a)+" more");return T(b+a+"</div>")}
function ZMf(a,b,c){b=c||b;xa(a.jN);c=a.jN;xa(a.wGa);a=a.wGa;for(var d='<div style="outline: none; overflow:hidden;"><div class="'+U("waffle-assistant-card-feedback")+'"></div>',e=Math.max(0,Math.ceil(Math.min(3,c.length))),f=0;f<e;f++){var h=f;d+=XMf({Xf:c[h],sna:a[h]})}if(3<c.length){d+=YMf({jYa:c.length-3},b)+'<div class="'+U("waffle-inline-assistant-overflow-suggestions")+'" style="display:none">';b=Math.max(0,Math.ceil(c.length-3));for(e=0;e<b;e++)f=3+e,d+=XMf({Xf:c[f],sna:a[f]});d+="</div>"}d+=
'<div style="float:right"><div class="'+U("waffle-inline-assistant-accept-button")+'">';d=d+"Trim all whitespace</div></div>"+(VMf()+"</div>");return T(d)}function $Mf(){return T('<div class="waffle-inline-assistant-sidebar-intro">See these suggestions also by using the toolbar menu Data -> Cleanup suggestions.<br><br>Tip: hover over suggestions to preview changes on the sheet</div>')}
function aNf(a,b,c){a='<div class="waffle-inline-assistant-sidebar-insights-cta-container"><div class="waffle-inline-assistant-sidebar-divider"></div><div class="waffle-inline-assistant-sidebar-insights-header">Get more insights about your data</div>'+R(OA({dd:"waffle-inline-assistant-sidebar-insights-cta",content:"Review column stats",style:2},c||b));return T(a+"</div>")}
function bNf(a){var b=a.pAa;xa(a.aQ);var c=a.aQ;a=a.pq;b='<div style="outline: none"><div class="'+U("waffle-inline-assistant-recommendation-container")+'">'+(a?'<div class="'+U("waffle-inline-assistant-rd-deleted-strikethrough")+'"></div><div class="'+U("waffle-inline-assistant-gridrange-chip")+'">'+R(b+1)+"</div>":'<div class="'+U("waffle-inline-assistant-gridrange-chip")+" "+U("waffle-inline-assistant-gridrange-chip-neutral")+'">'+R(b+1)+"</div>")+'<div class="'+U("waffle-inline-assistant-suggestion-row")+
'"><div class="'+U("waffle-inline-assistant-rd-cell-preview")+'">';a=c.length;for(var d=0;d<a;d++)b+=R(c[d])+'<div class="'+U("waffle-inline-assistant-rd-cell-value-divider")+'"></div>';return T(b+"</div></div></div></div>")}
function cNf(a,b,c){b=c||b;xa(a.X_a);c=a.X_a;xa(a.aQ);a=a.aQ;for(var d='<div tabindex=0 role="region" style="overflow:hidden"><div class="'+U("waffle-assistant-card-feedback")+'"></div>'+bNf({pAa:c[0],aQ:a,pq:!1}),e=Math.max(0,Math.ceil(Math.min(3,c.length)-1)),f=0;f<e;f++)d+=bNf({pAa:c[1+f],aQ:a,pq:!0});if(3<c.length){d+=YMf({jYa:c.length-3},b)+'<div class="'+U("waffle-inline-assistant-overflow-suggestions")+'" style="display:none">';b=Math.max(0,Math.ceil(c.length-3));for(e=0;e<b;e++)d+=bNf({pAa:c[3+
e],aQ:a,pq:!0});d+="</div>"}d+='<div style="float:right"><div class="'+U("waffle-inline-assistant-accept-button")+'">';d=d+"Remove duplicate rows</div></div>"+(VMf()+"</div>");return T(d)}
function dNf(a,b,c){b=c||b;c=a.Zab;a=a.r5b;b='<div class="'+U("waffle-inline-assistant-sidebar-category-container")+'"><div class="'+U("waffle-inline-assistant-sidebar-category-header")+'"><div class="'+U("waffle-inline-assistant-sidebar-category-label")+'">'+R(c)+'</div></div><div class="'+U("waffle-inline-assistant-sidebar-category-cards")+'"></div><div class="'+U("waffle-inline-assistant-sidebar-category-show-more-button docs-material")+'">'+R(gC({icon:"docs-icon-img docs-icon-chevron-down-24"},
b));a=CT(new wB("{NUM_OVERFLOW_CARDS_1,plural,=1{Show {NUM_OVERFLOW_CARDS_2} more suggestion}other{Show {NUM_OVERFLOW_CARDS_2} more suggestions}}"),{NUM_OVERFLOW_CARDS_1:a,NUM_OVERFLOW_CARDS_2:R(a)});return T(b+a+"</div></div>")}
function eNf(a){var b=a.lZ,c=a.Cna;a='<div class="'+U("waffle-assistant-anomaly-description")+'">';1==b?(b='This cell is not a <span style="font-weight:bold; text-transform: lowercase;">'+(R(c)+"</span>"),a+=b):1<b&&(b='These cells are not <span style="font-weight:bold; text-transform: lowercase;">'+(R(c)+"s</span>"),a+=b);return T(a+"</div>")}
function fNf(a,b,c){b=c||b;xa(a.vGa);c=a.vGa;a=a.abb;for(var d='<div tabindex=0 role="region" style="position:relative; outline:none"><div tabindex="0" role="textbox" class="'+U("waffle-anomaly-grey-out")+" "+U("waffle-assistant-card-anomaly")+'"></div>',e=Math.max(0,Math.ceil(c.length)),f=0;f<e;f++){var h=b;var k=c[0+f],l=a;k='<div tabindex=0 role="textbox" class="'+U("waffle-assistant-card-single-anomaly")+" "+U("waffle-assistant-card-single-anomaly"+k)+'" style="outline: none;"><div class="'+U("waffle-assistant-card-feedback")+
'"></div><div class="'+U("waffle-assistant-input-container")+" "+U("waffle-assistant-input-container"+k)+'"><div class="'+U("waffle-assistant-input-cell-chip")+'">'+R(k)+'</div><div class="'+U("waffle-assistant-form")+'">';k+='<div class="'+U("waffle-assistant-input-edit-icon")+'">'+R(gC({icon:"docs-icon-img docs-icon-edit-outline-20"},h))+'</div><div class="'+U("waffle-assistant-input-return-icon")+'" style="display:none">'+T('<svg xmlns="http://www.w3.org/2000/svg" height="18px" viewBox="0 0 24 24" width="18px" fill="#188038"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 7v4H5.83l3.58-3.59L8 6l-6 6 6 6 1.41-1.41L5.83 13H21V7z"/></svg>')+
'</div><input type="text" class="'+U("jfk-textinput")+" "+U("waffle-assistant-anomaly-input")+'" placeholder="'+U("New cell value")+'" aria-label="'+U("New cell value")+'" value="'+U(l)+'"/></div></div></div>';h=T(k);d+=h}d+='<div class="'+U("waffle-assistant-anomaly-apply-all-container")+'"><div class="'+U("waffle-assistant-anomaly-apply-to-all-text")+'">';d=d+'Apply to all</div><div class="'+(U("waffle-assistant-anomaly-apply-all-check")+'"></div></div></div>');return T(d)}
function gNf(a,b,c){var d=a.Vc(),e=a.Wc();switch(b){case 0:d=Math.min(d,a.tc()+c);break;case 1:e=Math.min(e,a.rc()+c)}return lSb(a.gb(),a.tc(),a.rc(),d,e)}
function hNf(){return T('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content"><div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret"></div></div><div class="waffle-assistant-answercard-answer-content"><div class="waffle-assistant-answercard-pivot-content"></div></div></div></div>')}
function iNf(a,b,c){b=c||b;return T(R(OA({dd:"waffle-assistant-insert-pivottable-button waffle-assistant-readonly-hidden",content:Dx(""+R(gC({icon:"docs-icon-img docs-icon-insert-pivot-table"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+R(OA({dd:"waffle-assistant-zoom-button",content:Dx(""+R(gC({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))}
function jNf(a,b,c,d,e,f,h){pX.call(this,a,b,c,new w4e,"regular",e,f,h);this.Pa=d;this.O=new Hz(null,new CR,this.oa());this.Fa(this.O);a=a.C;c=new CO(c,!0,!0);this.V=new L5e(a,new k1e(c),b);this.V.Ba=this.F;b=Sn(Zn(vdc(sdc(),!0),12,Jpb));this.Oa=new E6e(b);this.D=this.xa=null;this.ma=[]}t(jNf,pX);m=jNf.prototype;m.Fc=function(a){pX.prototype.Fc.call(this,a);this.O.Va(this.oa().bb("waffle-answers-button"))};
m.Ga=function(){pX.prototype.Ga.call(this);this.getHandler().listen(this.Pa,"selectionChange",this.RVb)};m.AVa=function(a){this.V.L=a;this.R.mE(a)};m.FX=function(){pX.prototype.FX.call(this);this.getHandler().listen(this.O,"action",this.xpb);kNf(this)};m.$F=function(){var a=this.J;return JI(a.C)?aTe(a)?pX.prototype.$F.call(this):!1:!1};m.Ma=function(a){pX.prototype.Ma.call(this,a);DW(this.O.getElement(),a?"":this.Hba());this.O.Ma(a)};
m.BKa=function(){if(this.D){var a=ao(ritz_api.TablesApi.getTableGridRange(this.D));a=NG(a);return XZe(a,FI(this.J.C))}return null};m.yBa=function(){if(this.D){var a=ao(ritz_api.TablesApi.getTableGridRange(this.D));if(50>OG(a).height)return!1}a=$o("docs-titlebar-buttons");a=a.offsetWidth+mx(a).right;return(fx(this.H.getElement())?a:a+200)+700<=window.innerWidth};m.Hba=ea("Answers is unavailable, try using Explore");
m.jO=function(){pX.prototype.jO.call(this);var a=B6e(this),b=this.yBa();this.O.setVisible(!b&&a)};m.xpb=function(){vYe(null,this.ma,null,this.F)};m.jRa=function(a){vYe(a,this.ma,null,this.F)};m.RVb=function(){lNf(this)&&kNf(this)};m.Wta=function(){var a=pX.prototype.Wta.call(this);a&&(this.D=null,lNf(this)&&kNf(this));return a};function lNf(a){a=a.J;return JI(a.C)&&SM(a)}
function kNf(a){if(a.$F()){var b=a.J.C,c=MI(b),d=ipd(c);if(0<d.length)b=ao(ritz_api.TablesApi.getTableGridRange(d[0])),a.D&&b.equals(ao(ritz_api.TablesApi.getTableGridRange(a.D)))||(a.D=d[0],a.I8());else if(null!=a.D){d=ao(ritz_api.TablesApi.getTableGridRange(a.D));b=d.gb()!=FI(b);var e=!1;if(!b){var f=AJ(c);c=ritz_api.TablesApi.getCurrentlyDetectedTables(MG(f,c.$b()).qb());c=ja(c);for(f=c.next();!f.done;f=c.next())if(f=ao(ritz_api.TablesApi.getTableGridRange(f.value)),f==d||null!=f&&f.equals(d)){e=
!0;break}}if(b||!e)a.D=null,a.L.C(36726,C6e(a)),a.I8()}}else a.XB()}m.I8=function(){var a=this;this.XB();if(this.D){var b=ao(ritz_api.TablesApi.getTableGridRange(this.D)),c=[NG(b)];null!=this.xa&&this.xa.cancel();5E4<jYe(b)?this.L.C(36727,C6e(this)):(this.xa=F6e(this.Oa,c),this.xa.then(function(d){a.sb()&&mNf(a,d.C)}).Vh(function(){a.XB()}))}};
function mNf(a,b){a.ma=b;var c=null;b=ja(b);for(var d=b.next();!d.done;d=b.next())d=d.value,3==Qg(d,1)&&(c=d);if(c&&.6<C(c,2)){a.L.C(36728,C6e(a));b=C(c,9)||new EJ;var e=Uc(Pg(b,1),function(l){return l.getName()}),f=[],h=[];d=ja(Pg(b,2));for(var k=d.next();!k.done;k=d.next())k=k.value,f.push(k.getName()),h=h.concat(Pg(k,2));d=go(PV(c));k=Kg(c,11)?C(c,11):null;c=null==k?null:go(C(c,10));a.V.init(b,d,c,k,[],[]);a.V.JY();a.V.NY().then(function(l){var n=h;l=void 0===l?[]:l;(e.length||f.length||n.length||
l.length)&&a.Ma(!0);a.R.cja(e,f,n);0<l.length&&(a.R.g_(l),z(y(),"feaipu")&&a.C&&a.C.D.setAttribute("placeholder","Try '"+(l[0].query+"'")));a.C&&r4e(a.C)})}wYe(a.ma,null,a.F)}m.XB=function(){pX.prototype.XB.call(this);this.ma=[];this.V.reset();wYe(null,null,this.F)};function nNf(a,b){tS.call(this,void 0,b,!1,!0);this.H=a;this.setTitle("Additional info");this.C.setVisible(!1)}t(nNf,tS);
nNf.prototype.Aa=function(){var a=this;tS.prototype.Aa.call(this);Zx(this.Ka(),"waffle-assistant-feedback-product-info-dialog");var b=Object.keys(this.H).map(function(c){var d=a.H[c];return Ge("DIV",void 0,[Ge("DT",void 0,c+":"),Ge("DD",void 0,String(d))])});vy(this,He(b))};nNf.prototype.Ga=function(){tS.prototype.Ga.call(this);var a=xy(this);if(a){var b=Ux(a);dA(a,b,void 0)}};
function oNf(a){var b=a.HS,c=a.index,d=a.checked;return T(R($R({dd:"waffle-assistant-feedback-dialog-radio-button",name:Dx(""+R(a.name)),label:b,checked:d,value:c+1},void 0)))}
function pNf(){var a='<div class="'+U("waffle-assistant-feedback-dialog-legal")+'"><small><div class="'+U("waffle-assistant-feedback-dialog-legal-information-text")+'">';a=a+'We will use the information you give us to help address technical issues and to improve our services, subject to our  <a href="https://www.google.com/intl/en/policies/privacy/" target="_blank" class="uf-legal-link">Privacy Policy </a>   and  <a href="https://www.google.com/intl/en/policies/terms/" target="_blank" class="uf-legal-link">Terms of Service</a> .</div><div class="'+(U("waffle-assistant-feedback-dialog-product-info-display-text")+
'"><span tabindex="0" role="link">');return T(a+"What will be shared with Google?</span></div></small></div>")}function qNf(a,b){tS.call(this,void 0,b,!0,!0);this.R=a;this.L=a.Yxa();this.ma=a.Uqa();this.H=this.V=this.O=null;this.setTitle(a.Jqa());this.C.setContent("Submit")}t(qNf,tS);m=qNf.prototype;
m.Aa=function(){tS.prototype.Aa.call(this);Zx(this.Ka(),"waffle-assistant-feedback-dialog");var a=this.ma;var b=this.L.length,c=this.R.$qa();xa(a);var d="";if(0<b){d+='<div class="'+U("waffle-assistant-feedback-dialog-header")+'">';d=d+'Recent suggestions</div><div class="'+(U("waffle-assistant-feedback-dialog-suggestions-radio-buttons-control")+'">');b=Math.max(0,Math.ceil(b));for(var e=0;e<b;e++){var f=e;d+=oNf({name:"waffle-assistant-feedback-dialog-suggestions-radio-buttons",HS:"",checked:f==
c,index:f})}d+="</div>"}d+='<div class="'+U("waffle-assistant-feedback-dialog-header")+'">';d+="Issue</div>";if(0<a.length){d+='<div class="'+U("waffle-assistant-feedback-dialog-feedback-radio-buttons-control")+'">';c=a.length;for(b=0;b<c;b++)d+=oNf({name:"waffle-assistant-feedback-dialog-feedback-radio-buttons",HS:a[b],checked:!1,index:b});d+=oNf({name:"waffle-assistant-feedback-dialog-feedback-radio-buttons",HS:"Other",checked:!1,index:a.length});d+="</div>"}d+='<div class="'+U("waffle-assistant-feedback-dialog-other-feedback-textarea-wrapper")+
'"><textarea class="'+U("waffle-assistant-feedback-dialog-other-feedback-textarea")+" "+U("jfk-textinput")+'" placeholder="'+U("Tell us a bit more")+'"></textarea></div>';a=T(d);vy(this,yx(a));a=yy(this);this.oa().Os(a,Ty(pNf),0)};
m.Ga=function(){var a=this;tS.prototype.Ga.call(this);var b=xy(this);b&&nbb(b,Ux(b));if(0<this.L.length)for(this.O=h2e("waffle-assistant-feedback-dialog-suggestions-radio-buttons",this.Ea("waffle-assistant-feedback-dialog-suggestions-radio-buttons-control")),this.qa(this.O),b=0;b<this.L.length;b++){var c=this.L[b];YW(this.O,b).XH(this.R.render(c))}0<this.ma.length&&(this.V=h2e("waffle-assistant-feedback-dialog-feedback-radio-buttons",this.Ea("waffle-assistant-feedback-dialog-feedback-radio-buttons-control")),
this.qa(this.V));b=this.Ea("waffle-assistant-feedback-dialog-product-info-display-text");c=new az(b);this.qa(c);this.getHandler().listen(b,"click",this.TQa).listen(c,"key",function(d){13===d.keyCode&&(a.TQa(),d.stopPropagation())})};m.Fz=function(){var a=rNf(this);hsb.pb(a,a.AXa);var b=this.R.mca();b&&b(a);tS.prototype.Fz.call(this)};
function rNf(a){var b=null;a.O&&(b=parseInt(d2e(a.O),10)-1,b=a.L[b]);var c=-1;a.V&&(c=parseInt(d2e(a.V),10)-1);var d=a.Ea("waffle-assistant-feedback-dialog-other-feedback-textarea");d=Cd(d.value)||"[No feedback entered]";return a.R.Xxa(b,c,d)}m.TQa=function(){var a=this,b=rNf(this).hha;this.H=new nNf(b,this.oa());this.H.setVisible(!0);this.getHandler().listen(this.H,"hide",function(){Jf(a.H);a.H=null})};m.Ia=function(){tS.prototype.Ia.call(this);Jf(this.H)};
function sNf(){return T('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function tNf(a,b,c){b=c||b;return T(R(OA({dd:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:Dx(""+R(gC({icon:"docs-icon-img docs-icon-insert-autovis-chart"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+R(OA({dd:"waffle-assistant-zoom-button",content:Dx(""+R(gC({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))}function uNf(a,b,c,d){Q.call(this,d);this.O=a;this.D=b;this.C=c;Dz(yz(new xz,10))}
t(uNf,Q);uNf.prototype.JOa=function(a,b){this.F(this.O,2746,a,b)};
function vNf(a){var b=a.Ljb,c='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">',d='By <span class="waffle-assistant-facet-title">'+(R(a.Obb)+"</span>");a=0==b.length;c=c+d+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(a)b=T('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');else{d=
'<div class="waffle-assistant-facet-charts-container">';for(var e=b.length,f=0;f<e;f++){var h=b[f];d+=(0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';d=h?d+R(h):d+"(empty)";d+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}b=T(d+"</div>")}c+='<div class="waffle-assistant-facet-content-wrapper'+(a?" waffle-assistant-facet-white-section":"")+'">'+
b+(VC?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return T(c)}function wNf(){w0c.apply(this,arguments)}t(wNf,w0c);wNf.prototype.Ora=g("element");function xNf(){l0c.call(this);m0c(this,this);this.xa="waffle-assistant-dragged-card"}t(xNf,IQ);xNf.prototype.contains=function(a){return!!Qc(this.F,function(b){if(b.element==a)return!0})};
xNf.prototype.L3=function(a){var b=IQ.prototype.L3.call(this,a);a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0);return b};function yNf(a,b,c,d,e,f,h,k,l,n){uNf.call(this,e,f,h,n);this.V=a;this.L=b;this.ma=c;this.H=d;this.R=k;this.J=l}t(yNf,uNf);yNf.prototype.Ga=function(){uNf.prototype.Ga.call(this);I3e(this.ma,this.Ka(),this.D,this.C,void 0,void 0,this.H)};
yNf.prototype.F=function(a,b,c,d){MI(this.V).dispatchEvent(new s1e(this.L.copy(),this.H,a,b,c,d,void 0,this.R,this.J))};function zNf(a,b,c,d,e,f){uNf.call(this,c,d,e,f);this.R=a;this.J=b;this.H=null}t(zNf,uNf);zNf.prototype.Ga=function(){uNf.prototype.Ga.call(this);(new YV(Ync,this.J.Gl)).send(u(this.L,this,this.J))};zNf.prototype.F=function(a,b,c,d){this.dispatchEvent(new t1e(this.R.clone(),a,this.H,b,c,d))};
zNf.prototype.L=function(a,b){if(b)if(b.Bk())fM.zJ(this.Ka(),b);else{a.Jj(b.Qe());TW(a,a.Qe());var c=(b=a.Qe())?b.toJSON():null,d=ritz.charts.model.GvizChart.create();d.updateChartWrapperJsonString(a.toJSON());c&&d.updateDataTableJsonString(c);I3e(d,this.Ka(),this.D,this.C,void 0,void 0,void 0);this.H=b}};
function ANf(a,b,c,d,e,f,h,k){Q.call(this,k);this.C=a;this.Sa=b;this.Ja=c;this.Pa=d;this.R=e;this.Ha=f;this.Oa=h;this.H=Pg(this.C,23);this.O=C(this.C,22);this.F=C(this.C,26);this.V=[];this.Na=new vl;this.xa=this.L=this.D=null;this.Ba=!1;this.Da=new PA("",this.oa());this.Fa(this.Da);this.J=this.ma=null}t(ANf,Q);m=ANf.prototype;m.Aa=function(){Q.prototype.Aa.call(this);this.jb(Ty(vNf,{Obb:this.F,Ljb:this.H}));this.Ka().style.visibility="hidden"};
m.Ga=function(){Q.prototype.Ga.call(this);var a=this.Ea("waffle-assistant-facet-toggle");this.Da.Va(a);this.getHandler().listen(this.Ka(),"mousedown",this.NVb).listen(this.Da,"action",this.uKb);VC&&(this.xa=new R_e("assistantAutovisFacetFeedback",null,"",this.oa()),this.xa.render(this.Ea("waffle-assistant-facet-feedback-container")),this.D=new W_e(this.oa()),this.Fa(this.D),this.D.render(this.Ea("waffle-assistant-facet-thumbs-container")),X_e(this.D,this.H.length?"Were these charts useful?":"Was this chart useful?"),
this.getHandler().listen(this.D,"thumbs-up",this.lKb).listen(this.D,"thumbs-down",this.kKb));BNf(this,z(y(),"fefsbd"))};m.Rd=g("Ba");m.NVb=function(a){a.stopPropagation()};m.uKb=function(){var a=Yx(this.Ea("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");BNf(this,a);CNf(this,a?2647:2646)};
function BNf(a,b){var c=a.Ea("waffle-assistant-facet-toggle");Ap(c,b?"HIDE":"SHOW");ky(a.Ea("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);Qc(a.Jg("waffle-assistant-faceted-chart"),function(e){Bp(e,b)});a.D&&P(a.D.Ka(),b);var d='Show chart broken down by "'+(a.F+'"');a='Hide chart broken down by "'+(a.F+'"');DW(c,b?a:d)}
function DNf(a,b){var c=a.Jg("waffle-assistant-faceted-chart");1==c.length&&2==b.getTypeOrdinal()&&b.setStackingType(1);var d=C(a.C,28).clone();Og(d,1);for(var e=Pg(a.C,27),f=0;f<e.length;f++)d.addRange(e[f]);for(e=0;e<c.length;e++){f="string"===typeof a.H[e]?a.H[e]:null;var h=b.copy();f?h.setFilter(a.O,f):h.setFacet(a.O,[a.O-1]);var k=a,l=h.getTitle();l||(l=mZe(h));h.setTitle(ENf(k,l,f));k=h.copy();l=xl(a.Na.qb(d),hg);k.setChartDataSource(ritz_api.ChartsApi.createChartDataSource(l));K3e(k);l=new yNf(a.Sa,
h,k,d,a.Ja,a.Pa,a.R,C(a.C,29),a.Oa,a.oa());a.Fa(l);var n=c[e];l.Va(n);a.V.push(l);FNf(a,n,mZe(h),f);a.ma=k}GNf(a);a.Ka().style.visibility="visible"}function FNf(a,b,c,d){var e=c+(' broken down by "'+(a.F+('" for "'+(d+'"'))));a=c+(' broken down by "'+(a.F+'"'));Vx(b,d?e:a)}function ENf(a,b,c){var d=b+(' when "'+(a.F+('" is "'+(c+'"'))));a=b+(' by "'+(a.F+'"'));return c?d:a}
function HNf(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.De()&&a.setOption("isStacked",!0)}function INf(a){"BarChart"==a.De()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function GNf(a){a.Ba||Qc(a.V,function(b){var c=b.Ka();if(!a.Ha.contains(c)){var d=a.Ha;b=new wNf(c,b);n2c(d,b)}})}m.lKb=function(){CNf(this,2649)};m.kKb=function(){CNf(this,2648);this.xa.show(!0)};function CNf(a,b){if(a.ma)Jwd(a.R,b,new MR,10,a.ma,C(a.C,28));else if(a.J){var c=a.R,d=new MR,e=a.J.De();d.F=e;(e=a.J.Qe())?d.C=e.clone():d.C=null;Owd(c,b,d,10,a.J,a.J.Gl)}}
function JNf(a,b,c,d,e,f,h,k){GW.call(this,a,k);this.J=QV(a);this.L=b;this.kb=c;this.rb=d;this.R=e;this.Pa=f;this.Ib=h;this.ma=new PA("",this.oa());this.Fa(this.ma);this.xa=new PA("",this.oa());this.Fa(this.xa);this.Oa=new vl;this.cb=null;this.Ja=!1;this.Wa=[];this.Sa=[];this.Za=[];this.Ha=this.C=this.D=this.Ba=null;this.Na=[];a=XZe(this.Ib,FI(b));this.F=Dz(zz(yz(new xz,10),a))}t(JNf,GW);m=JNf.prototype;m.YB=function(a){var b=this;this.isDisposed()||(ritz_api.ChartsApi?(this.cb=a,KNf(this)):ritz_api.RitzEntryPoint.loadChartsApi(function(){b.YB(a)}))};
m.KC=function(){var a=this;if(!this.isDisposed())if(z(y(),"fecpmr"))if(ritz_api.ChartsApi){var b=qZe(this.createChartModel(),C(this.J,28));Vx(this.Ka(),b)}else ritz_api.RitzEntryPoint.loadChartsApi(function(){a.KC()});else LNf(this,function(c){c&&(c=rZe(a.L,c),Vx(a.Ka(),c))},!1)};m.kI=ea(!0);m.rD=ea("autovisFeedback");m.$G=ea(2208);m.ZG=ea(2207);m.pca=ea("Was this chart useful?");
m.Aa=function(){GW.prototype.Aa.call(this);HW(this).appendChild(Ty(sNf));$_e(this).appendChild(Ty(tNf));if(Kg(this.J,22)){this.C=new ANf(this.J,this.L,this.V,this.rb,this.R,this.Pa,this.Na,this.oa());this.Fa(this.C,!0);var a=this.C,b=this.Rd();a.Ba=b;GNf(a)}};
m.Ga=function(){GW.prototype.Ga.call(this);Zx(this.Ka(),"waffle-assistant-card-draggable");var a=this.Ea("waffle-assistant-insert-chart-button");this.ma.Va(a);DW(a,"Insert chart");a=this.Ea("waffle-assistant-zoom-button");this.xa.Va(a);DW(a,"View full size");a=this.Ea("waffle-assistant-before-chart-preview");var b=this.Ea("waffle-assistant-after-chart-preview");this.getHandler().listen(this.Ka(),"keydown",this.LVb).listen(a,"focus",this.lqb).listen(b,"focus",this.gpb).listen(this.ma,"action",this.ezb).listen(this.ma.Ka(),
"mousedown",this.lxa).listen(this.xa,"action",this.kMb).listen(this.xa.Ka(),"mousedown",this.lxa).listen(this.Ea("waffle-assistant-chart-highlights"),"mousedown",this.lxa).listen(UG(this.L),"Kb",this.MVb);MNf(this);this.R.C(2790,this.F);this.C&&this.R.C(2791,this.F)};m.Jw=function(a){GW.prototype.Jw.call(this,a);MNf(this);this.sb()&&NNf(this)};function MNf(a){if(a.sb()){var b=a.Rd();a.ma.setVisible(!b);a=a.oa().Ea("waffle-assistant-button-separator",$_e(a));P(a,!b)}}
m.LVb=function(a){13==a.keyCode&&a.target==this.Ka()&&(a.preventDefault(),a.stopPropagation(),ONf(this,2255))};
function PNf(a){var b=a.De(),c=!!C(a.J,14),d=C(a.J,16),e=!!C(a.J,15),f="Histogram"==b;b="PieChart"==b;var h=io(Pg(a.H,4));if(!h[0]||h[0].C==FI(a.L)){for(var k=1<h.length,l=[],n=0;n<h.length;n++){var q=h[n].rect;q=c!=b?gBa(q,new Rm(q.width,1)):gBa(q,new Rm(1,q.height));kd(l,q)}c=VJ(a.kb).F;var r=[];for(w in QAa)r.push(Axc(c,QAa[w]));var w=Uc(l,function(x){return Uc(r,Ia(hn,x))});f&&e&&(w=ld(w,1));a.Za=QNf(w.length,b&&0<d||!f&&!b&&e,b&&k);d=VJ(a.kb);for(e=0;e<w.length;e++)for(f=a.Za[e],b=0;b<w[e].length;b++)w[e][b]&&
An(w[e][b])&&(k=FTe(d,w[e][b],"waffle-assistant-styled-rect"),a.qa(k),lP(d.V,"default",k,!0),Ow(k.Ka(),"background-color",f),k.setVisible(!0),a.Wa.push(k),k=oP(d,w[e][b],"waffle-assistant-styled-border",1,0),a.qa(k),Dwc(k,f),k.setVisible(!0),a.Sa.push(k))}}function RNf(a){Kf(a.Wa);Kf(a.Sa);a.Wa=[];a.Sa=[];a.Za=[]}m.MVb=function(){this.Ja&&(RNf(this),PNf(this))};m.fS=function(){GW.prototype.fS.call(this);this.Ha=Na();this.Ja||(PNf(this),this.Ja=!0)};
m.mM=function(){GW.prototype.mM.call(this);"number"===typeof this.Ha&&500<Na()-this.Ha&&this.R.C(2789,this.F);this.Ha=null;RNf(this);this.Ja=!1};m.lqb=function(){var a=this.Ea("waffle-assistant-chart-highlights");fx(a)?a.focus():this.Ka().nextSibling&&this.Ka().nextSibling.focus()};m.gpb=function(){this.O&&S_e(this.O)||this.xa.Ka().focus()};m.ezb=function(){ONf(this,2255)};m.lxa=function(a){a.stopPropagation()};m.kMb=function(){Csb.pb(this,this.F)};m.JOa=function(a,b){ONf(this,2257,a,b)};
function ONf(a,b,c,d){if(z(y(),"fecpmr")){var e=a.createChartModel();MI(a.L).dispatchEvent(new s1e(e,C(a.J,28),a.V,b,c,d,wk(a.F),C(a.J,29),a.Na))}else LNf(a,function(f){f&&(f=new t1e(f,a.V,a.D&&a.D.Qe(),b,c,d,wk(a.F),C(a.J,29),a.Na),MI(a.L).dispatchEvent(f))},!1)}function SNf(a,b){I3e(b,TNf(a),a.rb,a.R,function(){null!==a.Ba&&(Wk(Tk(),a.Ba),a.Ba=null);a.isDisposed()||(a.cb(),NNf(a))})}function NNf(a){if(!a.Rd()){var b=TNf(a);if(!a.Pa.contains(b)){var c=a.Pa;a=new wNf(b,a);n2c(c,a)}}}
function UNf(a,b,c){var d=[];try{var e=a.Oa.qb(c),f=xl(e,hg),h=ritz_api.RitzModelApi.getVerbalHighlightsForProto(f,ritz.charts.model.ChartTypes.toGviz(b.getTypeOrdinal()),0!=b.getStackingTypeOrdinal(),b.getTitle(),nX(b,ritz.charts.model.AxisNames.X),nX(b,ritz.charts.model.AxisNames.Y),nX(b,ritz.charts.model.AxisNames.RIGHT),b.getDomainDataBacked());d=Uc(h,x6e)}catch(k){d=[]}a=a.Ea("waffle-assistant-chart-highlights");P(a,0<d.length);0<d.length&&(a.appendChild(d[0]),Bp(a,!0))}
m.createChartModel=function(){VNf(this);var a=ritz.charts.model.ChartImpl.create(),b=C(this.J,28);ritz_api.ChartsApi.setChartModel(a,xl(this.Oa.qb(b.Rk()),Yf));b=xl(this.Oa.qb(b),hg);a.setChartDataSource(ritz_api.ChartsApi.createChartDataSource(b));return a};function WNf(a){VNf(a);C(a.J,16);var b=T0e(a.J);b.OAa(Ync);var c=D0e(a.H);b.Xo(c.toString());a.C&&(c=c.clone(),a.C.L=c);return b}function VNf(a){a.ye&&(a.Ba=Vk(Tk(),"aaoar"),a.ye=!1)}
function KNf(a){if(z(y(),"fecpmr")){var b=a.createChartModel(),c=b.copy();K3e(c);UNf(a,b,C(a.J,28));SNf(a,c);a.C&&DNf(a.C,b)}else{var d=U0e(WNf(a),a.Ea("waffle-assistant-card-inner"));(new YV(Ync,d.Gl)).send(function(e){if(e)if(e.Bk())fM.zJ(TNf(a),e);else{d.Jj(e.Qe());TW(d,d.Qe());e=new Ns;e.setContext(d.toJSON());var f=!!C(a.J,14);D(e,3,f);var h=C(a.J,16);D(e,4,h);D(e,5,f);D(e,8,0);C(a.J,24)&&(f=C(a.J,25),D(e,9,f));f=io(Pg(a.H,4));for(h=0;h<f.length;h++)e.addRange(fo(f[h].rect,f[h].C));f=(f=d.Qe())?
f.toJSON():null;h=ritz.charts.model.GvizChart.create();h.updateChartWrapperJsonString(d.toJSON());f&&h.updateDataTableJsonString(f);UNf(a,h,e);a.D=d;e=(e=d.Qe())?e.toJSON():null;f=ritz.charts.model.GvizChart.create();f.updateChartWrapperJsonString(d.toJSON());e&&f.updateDataTableJsonString(e);SNf(a,f)}});a.C&&LNf(a,function(e){var f=a.C,h=d;e=new mM(e.toJSON());h=new mM(h.toJSON());var k=f.Jg("waffle-assistant-faceted-chart");if(1<k.length){INf(e);var l=h;HNf(l);l.setOption("pieSliceText","percentage");
l.setOption("axisFontSize",0);l.setOption("hAxis.title",null);l.setOption("hAxis.textPosition","none");l.setOption("vAxes.0.title",null);l.setOption("vAxes.0.textPosition","none");l.setOption("vAxes.1.title",null);l.setOption("vAxes.1.textPosition","none");l.setOption("legend","none");l.setOption("titleTextStyle.fontSize",0)}else l=e,INf(l),l.setOption("applyAggregateData",void 0),l.setOption("legend","right"),HNf(h);l=io(Pg(f.C,27));Znc(f.L,l);l=C(f.C,25);for(var n=0;n<k.length;n++){var q="string"===
typeof f.H[n]?f.H[n]:null,r=l.clone(),w=f.O,x=new Ts;D(x,1,w);"string"===typeof q&&x.setValue(q);D(r,7,x);f.L.mc("dt",encodeURIComponent(JSON.stringify(f.Na.qb(r))));r=new mM(e.toJSON());r.Xo(f.L.toString());w=h.clone();w.Xo(f.L.toString());x=f;var F=r.getOption("title");F||(F=nZe(r));x=ENf(x,F,q);r.setOption("title",x);w.setOption("title",x);x=new zNf(r,w,f.Ja,f.Pa,f.R,f.oa());f.Fa(x);F=k[n];x.Va(F);f.V.push(x);FNf(f,F,nZe(r),q);f.J=w}GNf(f);f.Ka().style.visibility="visible"},!1)}}
function LNf(a,b,c){var d=WNf(a);(new YV(Ync,d.Gl)).send(function(e){e?(e=e.Qe(),c&&d.Jj(e),TW(d,e),b(d)):b(null)})}m.De=function(){return this.J.De()};function QNf(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=R0e("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&kd(d,d);return d}function TNf(a){return a.Ea("waffle-assistant-chart-preview")}
function XNf(a,b,c){b=c||b;a=a.title;c='<div class="waffle-assistant-feature-section" tabindex="0" role="region" aria-label="';var d=" "+(U(a)+" Section ");c+=Fx(d);c+='"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+R(a)+"</div>";c+=R(OA({dd:"waffle-assistant-section-more-button",content:Dx("More"),style:4},b));return T(c+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>')}
function q_(a,b,c,d){Q.call(this,d);this.V=a;this.Za=b;this.xa=new PA("",this.oa());this.Fa(this.xa);this.L=new Q(this.oa());this.Fa(this.L);this.C=null;this.Na=[];this.ma=this.Ja=!1;this.R=c}t(q_,Q);m=q_.prototype;m.wRa=ea(!1);m.wBa=ea(!0);m.Aa=function(){Q.prototype.Aa.call(this);this.jb(Ty(XNf,{title:this.getTitle()}))};
m.Ga=function(){Q.prototype.Ga.call(this);this.L.Va(this.Ea("waffle-assistant-section-card-holder"));this.xa.Va(this.Ea("waffle-assistant-section-more-button"));this.getHandler().listen(this.xa,"action",this.sBb);this.C=this.yHa();this.qa(this.C);P(YNf(this),this.wRa());this.setVisible(!1)};m.setVisible=function(a){this.sb()&&this.isVisible()!=a&&(P(this.Ka(),a),a&&(P(this.xa.Ka(),this.O1a()),a=new gk,a=L(a,4,this.o6()),a=hk(new bk,a),a=Dz(zz(yz(new xz,10),a)),this.R.C(2774,a)))};
m.isVisible=function(){return this.sb()&&fx(this.Ka())};m.O1a=function(){return this.Na.length>this.V};m.yHa=function(){return new bX(this.oa())};m.iS=function(a){this.ma=a;Qc(ZNf(this),function(b){b.Jw(a)});O4e(this.C,a)};m.Rd=g("ma");m.BVa=ba();
m.gS=function(a){this.Na=a;for(var b=0;b<a.length;b++){if(this.L.zc()<this.V){var c=this.nV(a[b]);c.Jw(this.ma);var d=this.L.zc();c.V=d;this.L.Fa(c,!0)}if(this.wBa()&&(this.C.fJ(!1),c=this.nV(a[b]),c.Jw(this.ma),d=this.C,d.C.push(c),d.Ad)){M4e(d,!1);var e=d.O.zc();c.V=e;d.O.Fa(c,!0);c.yP()}}};function ZNf(a){var b=[];a.L.Xe(function(c){b.push(c)});return b}function YNf(a){return a.Ea("waffle-assistant-section-content")}m.iua=function(){return this.L.B4()};
m.hS=function(){this.Na=[];Kf(this.L.qd(!0));this.setVisible(!1);this.wBa()&&(this.C.i1(),this.C.fJ(!0))};function $Nf(a){a.L.Xe(function(b,c){c<this.V&&b.yP()},a)}m.p6=function(a){var b=0;if(this.Ja)this.C.CVa();else if(this.iua()){this.setVisible(!0);b=cx(this.Ea("waffle-assistant-section-header")).height+cx(YNf(this)).height;for(var c=ZNf(this),d=0;d<c.length;d++)b<a&&d<this.V?(this.YNa(c[d]),b0e(c[d],!0),b+=cx(c[d].Ka()).height):b0e(c[d],!1)}else this.setVisible(!1);return a-b};m.YNa=ba();
m.setActive=function(a){(this.Ja=a)||this.C.eaa()};m.Vb=g("Ja");m.Sn=function(a){this.C&&M4e(this.C,a)};function aOf(a,b){a.C.Dia(b,a.getTitle())}m.sBb=function(){this.setActive(!0);this.dispatchEvent("Kd")};function bOf(){return T('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')}function cOf(a,b){GW.call(this,a,b);this.C=QV(a)}t(cOf,GW);m=cOf.prototype;m.KC=ba();m.rD=ea("assistantWordCloudFeedback");
m.$G=ea(2634);m.ZG=ea(2633);m.Aa=function(){GW.prototype.Aa.call(this);HW(this).appendChild(Ty(bOf));Zx(HW(this),"waffle-assistant-word-cloud-content-container")};m.YB=function(a){for(var b=Pg(this.C,19),c=Pg(this.C,20),d=this.Ea("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(dOf(this,b,c,e),120<d.clientHeight){dOf(this,b,c,e-1);break}b=this.oa();c=C(this.C,2);c=Kp(b,c);d=this.Ea("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function dOf(a,b,c,d){var e=a.Ea("waffle-assistant-word-cloud-words-container");for(a=a.oa();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(Kp(a," "));var l=a.createElement("SPAN");a.appendChild(l,Kp(a,b[k]));a.appendChild(e,l);Zx(l,"waffle-assistant-word-cloud-word");var n=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(n-f)/(h-f)*15+9+"px"}}
function eOf(a,b,c,d,e,f){var h=Jc(y(),"fmnac");h||(h=20);q_.call(this,h,e,d,f);this.Ba=a;this.H=b;this.Da=c;this.D=new xNf;this.qa(this.D);this.F=null;this.O=0;this.J=null}t(eOf,q_);m=eOf.prototype;m.Ga=function(){q_.prototype.Ga.call(this);this.D.init();this.getHandler().listen(this.D,"drag",this.KVb).listen(this.D,"dragend",this.Hm)};m.getTitle=ea("Analysis");m.V0=function(a){return 0==a};
m.nV=function(a){return"WordCloud"==QV(a).De()?new cOf(a,this.oa()):new JNf(a,this.Ba,this.H,this.Da,this.R,this.D,this.J,this.oa())};m.iS=function(a){q_.prototype.iS.call(this,a);a&&p0c(this.D)};m.YNa=function(a){this.getHandler().Rc(a,"content-rendered",this.JVb);this.O++};m.gS=function(a,b){this.J=b||null;q_.prototype.gS.call(this,a,b);var c=a.map(function(d){return QV(d).De()});Qc(ZNf(this),function(d){d instanceof JNf&&(d.Na=c)})};m.JVb=function(){0==--this.O&&this.dispatchEvent("Gd")};
m.KVb=function(){this.F=Zw(this.D.Sc.target)};m.Hm=function(a){var b=this.F,c=VJ(this.H).C;if(Wm(RN(c,"page",!1,!1)).contains(b)){var d=mO(c,b.x,b.y,"page");c=oO(c,d,"page");b=new Km(b.x-c.left,b.y-c.top);a.C.getData().JOa(d,b)}this.F=null};m.o6=ea(2);
function fOf(a,b,c){b=c||b;a=T;c='<div class="'+U("waffle-assistant-answers-logging-message-container")+'"><div class="'+U("waffle-assistant-answers-logging-message")+'"><span class="'+U("waffle-assistant-answers-logging-text")+'">';c=c+"We're logging your queries and data to improve the feature.</span><div class=\""+(U("waffle-assistant-answers-learn-more")+'">');c=c+'Learn More</div><div class="'+(U("waffle-assistant-answers-logging-opt-out")+'">');c=T(c+"Opt-out for this file</div></div></div>");
return a(c+'<div class="'+U("waffle-assistant-answers-input")+" "+U("waffle-assistant-answers-input-with-icon")+'"><form class="'+U("waffle-assistant-answers-query-box")+'">'+R(a4e(b))+"</form></div>")}
function gOf(a,b,c,d,e,f,h,k,l,n){q_.call(this,1,f,e,n);this.Wa=c;this.cb=b;this.Ha=null;this.Da=new Hz("",new DR,this.oa());this.Fa(this.Da);this.Pa=new Hz("",new DR,this.oa());this.Fa(this.Pa);f=new CO(a,!0,!0);f=new k1e(f);this.Ba=new e0e(e);this.O=new L5e(this.Wa,f,e);this.H=new P5e(this.O,a,b,c,d,e,this.Za,f,this.Ba,h,k,l,this.oa());this.D=new bW(b,"waffle-assistant-answers-styled-border","waffle-assistant-answers-styled-rect");this.qa(this.D);this.F=this.J=null;this.Sa=Dz(yz(new xz,10));this.Oa=
!1}t(gOf,q_);m=gOf.prototype;m.Aa=function(){q_.prototype.Aa.call(this);var a=Ty(fOf);this.oa().appendChild(YNf(this),a)};
m.Ga=function(){q_.prototype.Ga.call(this);var a=this.Ea("waffle-assistant-answers-query-box"),b=this.Ea("waffle-assistant-answers-input-box");this.Pa.Va(this.Ea("waffle-assistant-answers-logging-opt-out"));this.Da.Va(this.Ea("waffle-assistant-answers-learn-more"));this.getHandler().listen(a,"focus",this.iFb,!0).listen(a,"blur",this.gFb,!0).listen(a,"mouseover",this.kFb).listen(a,"mouseout",this.jFb).listen(a,"click",this.hFb).listen(b,"input",this.TVb).listen(this.Pa,"action",this.nDb).listen(this.Da,
"action",this.Mzb).listen(UG(this.Wa),"Kb",mUe(this.UVb,25,this));this.setVisible(null!=this.J);hOf(this,Bpb&&Cpb&&WC("showAnswersLoggingOptOut"))};m.O1a=ea(!1);m.wRa=ea(!0);m.wBa=ea(!1);m.getTitle=ea("Answers");m.o6=ea(1);m.V0=function(a){return 3==a||0==a||1==a};
m.gS=function(a,b){pd(a,function(l,n){return C(n,2)-C(l,2)});for(var c=[],d=[],e=null,f=0;f<a.length;f++){var h=Qg(a[f],1);3==h?e=a[f]:0==h?c.push(QV(a[f])):1==h&&d.push(a[f])}if(e&&C(e,2)){f=b||null;h=Kg(e,11)?C(e,11):null;var k=null==h?null:go(C(e,10));0<Lg(e,4)?iOf(this,go(PV(e)),C(e,9),k,h,c,d):iOf(this,f,C(e,9),k,h,c,d);this.F||(q_.prototype.gS.call(this,a,b),this.getHandler().listen(this.F,"sqc",this.yJb))}else this.hS(!0)};
m.nV=function(a){if(!this.F){var b=t5e(this.O,3);this.F=new J5e(a,this.cb,this.R,this.Ba,b,F5e,"regular",void 0,this.oa())}return this.F};m.yHa=g("H");m.iua=function(){return this.isVisible()};m.hS=function(a,b,c){this.O.reset();(a||b)&&this.F&&(q_.prototype.hS.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||void 0!==b&&!b)this.F&&(q_.prototype.hS.call(this,a,b,c),this.F.dispose(),this.F=null),this.sb()&&(this.O.reset(),this.J=null,V5e(this.H),this.setVisible(!1),this.Vb()&&aW(this.D));c&&this.H.reset()};
m.Sn=function(a,b){b||M4e(this.H,a)};m.BVa=function(a){this.Ha=a;var b=this.H;b.Na=a;b.ma.mE(a);b.Da.mE(a);this.O.L=a;this.Ba.C=a};m.setActive=function(a){q_.prototype.setActive.call(this,a);a?dW(this.D,this.J):aW(this.D)};function jOf(a,b){a.Vb()&&(b?aW(a.D):dW(a.D,a.J))}function hOf(a,b){P(a.Ea("waffle-assistant-answers-logging-message-container"),b)}function kOf(a,b){a=a.Ea("waffle-assistant-answers-query-box");ky(a,"waffle-assistant-answers-query-box-focused",b)}
m.UVb=function(){this.Vb()&&dW(this.D,this.J)};m.iFb=function(){kOf(this,!0);dW(this.D,this.J)};m.gFb=function(){kOf(this,!1);this.Vb()||aW(this.D)};m.kFb=function(){dW(this.D,this.J)};m.jFb=function(){this.Vb()||aW(this.D)};m.hFb=function(){lOf(this,"")};m.TVb=function(){var a=this.Ea("waffle-assistant-answers-input-box");Ue(a.value)||(lOf(this,a.value),a.value="")};m.yJb=function(a){lOf(this,a.C,!1,!0,a);this.R.C(2652,this.Sa)};
function lOf(a,b,c,d,e){c=void 0===c?!1:c;d=void 0===d?!1:d;a.setActive(!0);a.dispatchEvent("Kd");mOf(a,b,c);if(d&&b){var f=new WS;e instanceof D5e?f=b_e(1,e.F,e.D,1):e instanceof g4e&&(f=h6e(e));c=new Jq(function(){U5e(a.H,b,f,e)},300);a.qa(c);c.start()}}function mOf(a,b,c,d,e){c=void 0===c?!1:c;d=void 0===d?!1:d;var f=new Jq(function(){var h=a.H;h.D&&q4e(h.D,b,!0);h=a.H;var k=c||!1;h.Ve=k;h.yd.R=k;h.Ec.R=k;d&&b&&(h=new WS,e&&(h=h6e(e)),U5e(a.H,b,h,e))},300);a.qa(f);f.start()}
function iOf(a,b,c,d,e,f,h){c=c||new EJ;a.J=b;a.O.init(c,b,d,e,f,h);a.O.JY();a.O.NY().then(function(k){var l=a.bb("waffle-assistant-answers-input-box");l&&0<k.length&&z(y(),"feaipu")&&l.setAttribute("placeholder","Try '"+(k[0].query+"'"))},null,a);a.setVisible(null!=b);S5e(a.H,b,c,d,e,a.Oa,f);a.Oa=!1;a.Vb()&&dW(a.D,a.J)}m.nDb=function(a){a.stopPropagation();a.preventDefault();this.Ha&&($q(Hl(Il(this.Ha.We("/answers/logoptout"),u(this.pAb,this)),u(this.oAb,this)),"POST").Pe(),this.R.C(2663,this.Sa))};
m.Mzb=function(a){a.stopPropagation();a.preventDefault();ux("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};m.pAb=function(a){a.Oj()&&hOf(this,!1)};m.oAb=ba();
function nOf(a,b,c){a=T;b=""+R(OA({dd:"waffle-assistant-datavalidation-apply-button",content:"Apply",style:4},c||b));b=T(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function oOf(a){return T('<div class="waffle-assistant-datavalidation-detail-chip">'+R(a.mdb)+"</div>")}
function pOf(a,b,c,d){GW.call(this,a,d);this.D=new bW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.qa(this.D);this.C=new PA("",this.oa());this.Fa(this.C);this.F=PV(a);this.L=c}t(pOf,GW);m=pOf.prototype;m.Aa=function(){GW.prototype.Aa.call(this);HW(this).appendChild(Ty(nOf))};
m.Ga=function(){GW.prototype.Ga.call(this);var a=this.Ea("waffle-assistant-datavalidation-apply-button");this.C.Va(a);DW(a,"Apply data validation");this.getHandler().listen(this.C,"action",this.Fpb).listen(this.Ka(),"mouseenter",this.nWb).listen(this.Ka(),"mouseleave",this.oWb);a=VPe(new gk,N6e(th(C(C(this.H,13),3))));a=hk(new bk,a);a=Dz(zz(yz(new xz,10),a));this.L.C(35577,a)};
m.YB=function(a){var b=IM(ho(this.F)),c=C(C(this.H,13),3);switch(th(c)){case 14:var d="Email validation";c=["Is valid email"];break;case 15:d="URL validation";c=["Is valid URL"];break;case 30:d="Date validation";c=["Is valid date"];break;case 24:d="List of items";c=uh(c).map(function(k){return C(k.Fn().getValue(),2)});break;case 1:d="Numeric validation";c=["Greater than "+C(uh(c)[0].Fn().getValue(),3)];break;case 7:d="Numeric validation";c=uh(c);c=["Between "+(C(c[0].Fn().getValue(),3)+(" and "+C(c[1].Fn().getValue(),
3)))];break;case 5:d="Numeric validation";c=uh(c);c=["Equal to "+C(c[0].Fn().getValue(),3)];break;default:d="unrecognized",c=[]}var e=new SC,f=e.text(d)+(" for "+(e.cd("SPAN".toString(),{MJ:"waffle-assistant-datavalidation-range"})+e.text(b)+e.$c("SPAN".toString())));mga(this.Ea("waffle-assistant-datavalidation-description"),e.format(f));var h=this.Ea("waffle-assistant-datavalidation-details");Qc(c,function(k){k=Ty(oOf,{mdb:k});h.appendChild(k)});b="Suggested data validation: "+(d+(" "+(c.join()+
(" for "+b))));Vx(this.Ka(),b);a()};m.KC=ba();m.rD=ea("assistantDataValidationFeedback");m.$G=ea(35551);m.ZG=ea(35550);m.Fpb=function(){this.dispatchEvent(new FW("Dd",this,35549))};m.nWb=function(){dW(this.D,go(this.F))};m.oWb=function(){aW(this.D)};function qOf(a,b,c,d){q_.call(this,1,b,a,d);this.D=c}t(qOf,q_);m=qOf.prototype;m.getTitle=ea("Data Validation");m.V0=function(a){return 6==a};
m.nV=function(a){var b=C(a,1);switch(b){case 6:return new pOf(a,this.D,this.R,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};m.iS=function(a){q_.prototype.iS.call(this,a);this.setVisible(!a)};m.p6=function(a){return this.Rd()?(this.setVisible(!1),a):q_.prototype.p6.call(this,a)};m.o6=ea(4);function rOf(a,b,c){FW.call(this,"Bd",a,b);this.D=c}t(rOf,FW);function sOf(a){a=""+R(OA({dd:"waffle-assistant-formatting-edit-button",content:"Edit",style:4},a));return T(a)}
function tOf(a,b,c){a='<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+(sOf(c||b)+"</div>");return T(a)}
function uOf(a,b,c){return T('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+sOf(c||b)+"</div>")}function vOf(a,b,c){FW.call(this,"Jd",a,b);this.D=c}t(vOf,FW);
function wOf(a,b,c,d){GW.call(this,a,d);a=Uc(Pg(this.H,7),R6e);this.C=new W6e(!1,a,7);this.Fa(this.C);this.L=new PA("",this.oa());this.Fa(this.L);this.ma=b;this.F=!1;this.D=-1;this.R=c}t(wOf,GW);m=wOf.prototype;m.Aa=function(){GW.prototype.Aa.call(this);HW(this).appendChild(Ty(tOf))};m.Ga=function(){GW.prototype.Ga.call(this);this.getHandler().listen(this.L,"action",this.Bvb).listen(this.C,"Ce",this.gqb);this.ma.C(2768)};
m.YB=function(a){var b=this.Ea("waffle-assistant-banding-color-picker-container");this.C.render(b);X6e(this.C);b=this.Ea("waffle-assistant-banding-range");var c=PV(this.H),d=ho(c);Ap(b,IM(d));xOf(this,c);b=this.Ea("waffle-assistant-formatting-edit-button");this.L.Va(b);a()};m.KC=function(){Vx(this.Ka(),"Suggested alternating background colors");this.C.Ee("Choose a color scheme")};m.rD=ea("assistantBandingFeedback");m.$G=ea(2672);m.ZG=ea(2671);
m.Bvb=function(a){OJ.dispatchEvent({type:"show-banding-pane-recommendation",l_a:this.H,Hcb:Z6e(this.C)});a.stopPropagation()};m.gqb=function(a){var b=this;if(!this.F&&Y6e(this.C)){var c=this.D;this.D=this.C.Li();this.D==c?this.dispatchEvent(new vOf(this,2797,function(){b.R.clear()})):this.dispatchEvent(new rOf(this,2673,function(){G1e(b.R,"Alternating colors applied",b.oa(),function(){b.dispatchEvent(new FW("Od",b,2796))})}));a.stopPropagation()}};
function xOf(a,b){a.F=!0;var c=b.gb();b=ho(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.tc(),b.rc(),b.Vc(),b.Wc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=wl(c,bia),c=(new vl).Od($s.getDescriptor(),c),c=R6e(c)):c=null;c?(c=$6e(a.C,c),tM(a.C,c?c.getElement():null)):tM(a.C,null);a.D=a.C.Li();a.F=!1}function yOf(a,b){iz.call(this,void 0,void 0,b);this.C=a}t(yOf,iz);
yOf.prototype.Fc=function(a){iz.prototype.Fc.call(this,a);var b=this.C.Vd;switch(b.length){case 0:break;case 1:var c="one-rule";break;case 2:case 4:c="two-rules";break;default:c="three-rules"}for(var d=0;d<b.length;d++){var e=b[d],f=dp("DIV");$x(f,["waffle-assistant-conditionalformat-format-preview",c]);var h=dp("DIV");Zx(h,"waffle-assistant-conditionalformat-format-preview-label");f.appendChild(h);Ap(h,"123");if(Kg(e,2)){var k=C(C(e,2),1);switch(th(xh(k))){case 9:case 13:k=uh(xh(k))[0];var l=Pg(e,
1)[0];Ap(h,nH(k,Qg(l,1),Qg(l,2),Qg(l,4)))}}l7e(e,f);a.appendChild(f)}};yOf.prototype.Rg=function(){var a=this.C;a.dispatchEvent(new FW("Cd",a,2563));return!0};function zOf(a,b){GW.call(this,a,b);this.C=new PA("",this.oa());this.Fa(this.C);this.Vd=Pg(a,6)}t(zOf,GW);m=zOf.prototype;m.Aa=function(){GW.prototype.Aa.call(this);HW(this).appendChild(Ty(uOf))};
m.Ga=function(){GW.prototype.Ga.call(this);var a=this.Ea("waffle-assistant-formatting-edit-button");this.C.Va(a);DW(a,"Apply and edit conditional format rules");this.getHandler().listen(this.C,"action",this.Dpb)};m.YB=function(a){Ap(this.Ea("waffle-assistant-conditionalformat-description"),Qg(this.H,3));var b=this.Ea("waffle-assistant-conditionalformat-rule-holder"),c=new yOf(this,this.oa());this.Fa(c);c.Va(b);DW(b,"Apply conditional format rules");a()};m.KC=ba();m.rD=ea("assistantConditionalFormatFeedback");
m.$G=ea(2630);m.ZG=ea(2629);m.Dpb=function(){this.dispatchEvent(new FW("Cd",this,2563));this.dispatchEvent(new FW("Fd",this,2670,void 0,void 0,ho(C(this.Vd[0],1,0))));z5b()};function AOf(a,b,c){q_.call(this,2,b,a,c)}t(AOf,q_);m=AOf.prototype;m.getTitle=ea("Formatting");m.V0=function(a){return z(y(),"feecfr")&&2==a||4==a};
m.nV=function(a){var b=C(a,1);switch(b){case 2:return new zOf(a,this.oa());case 4:return new wOf(a,this.R,this.Za,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};m.iS=function(a){q_.prototype.iS.call(this,a);this.setVisible(!a)};m.p6=function(a){return this.Rd()?(this.setVisible(!1),a):q_.prototype.p6.call(this,a)};m.o6=ea(3);function r_(a,b,c,d,e){Q.call(this);this.R=a;this.Sa=b;this.C=c;this.L=d;this.D=e}t(r_,Q);
r_.prototype.Gga=function(a,b,c){this.C=a;this.L=b;this.D=c};r_.prototype.Ga=function(){Q.prototype.Ga.call(this);this.getHandler().listen(this.R.C,"na",this.Wa)};r_.prototype.Wa=function(){this.Sa.pb()};function BOf(a,b,c,d){d=void 0===d?!1:d;FW.call(this,"Ld",null,2859);this.D=a;this.O=b;this.F=c;this.L=!!d}t(BOf,FW);
function COf(a,b){A.call(this);this.F=a;this.H=b;this.C=new bW(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.qa(this.C);this.D=new bW(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.qa(this.D)}t(COf,A);COf.prototype.Ia=function(){aW(this.C);aW(this.D);A.prototype.Ia.call(this)};
function DOf(a,b,c,d,e,f){dzc(b);var h=OG(d);h=new dn(h.tc(),h.rc(),Math.min(h.Vc(),h.tc()+6),Math.min(h.Wc(),h.rc()+6));var k=wO(b),l=VJ(a.F).C,n=kN(l,new Ym(h.tc(),h.Vc()),"r",!0,!1,!0,!0)-1,q=kN(l,new Ym(h.rc(),h.Wc()),"c",!0,!1,!0,!0)-1;l.kc()&&--q;n=Math.min(200,n);q=Math.min(c.offsetWidth-2,q);ezc(b,k,q,n);c=gNf(d,e,f);a.H.render(b,h,c);b=a.C;h=d.tc();k=d.rc();switch(e){case 0:h=Math.min(d.Vc(),d.tc()+f);break;case 1:k=Math.min(d.Wc(),d.rc()+f)}d=lSb(d.gb(),h,k,d.Vc(),d.Wc());dW(b,NG(d));dW(a.D,
NG(c))}
function EOf(a){var b=a.JZa,c=a.IZa,d=a.rYa;a=a.s$;return T('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+U(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+R(b)+'</div></div><div class="waffle-tables-popup-content">'+R(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+R(d)+
'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+R(a)+"</div></div></div></div>")}
function FOf(){var a=T('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Data Range</label><div class="waffle-assistant-tables-edit-sheet-button"></div></div><div class="waffle-assistant-tables-range-error" style="display:none">Invalid range</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper"><div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>');a=
""+EOf({JZa:"Edit data range",IZa:Dx(""+a),rYa:"Update",s$:"Cancel"});return T(a)}function GOf(){var a=""+EOf({JZa:"Improve suggestions",IZa:Dx('<div class="waffle-tables-popup-header-message"></div>'),rYa:"No",s$:"Yes"});return T(a)}function HOf(a){a='<div class="waffle-tables-bar-content">For <span class="waffle-assistant-table-bar-range">'+(R(a.zC)+"</span></div>");return T(a)}
function IOf(a){a='Is <span class="waffle-assistant-table-first-header">'+(R(a.iR)+"</span> a header row, containing titles that describe the columns below?");return T(a)}function JOf(a,b,c,d,e,f,h){r_.call(this,a,aBb,d,e,f);this.F=sC(new rC);this.qa(this.F);this.J=new Hz("",new CR,this.oa());this.Fa(this.J);KA(this.F,this.J,bBb);this.H=new Hz("",new CR,this.oa());this.Fa(this.H);KA(this.F,this.H,aBb);this.V=new COf(b,c);this.qa(this.V);this.O=new GA(this);this.qa(this.O);this.xa=h}t(JOf,r_);
JOf.prototype.Aa=function(){this.jb(Ty(GOf))};
JOf.prototype.Ga=function(){r_.prototype.Ga.call(this);this.J.Va(this.Ea("waffle-tables-popup-done"));this.H.Va(this.Ea("waffle-tables-popup-cancel"));var a=gNf(this.C,this.D,1);a=IM(OG(a));a=Ty(IOf,{iR:a});this.Ea("waffle-tables-popup-header-message").appendChild(a);this.O.subscribe(bBb,"action",this.Ba).subscribe(aBb,"action",this.ma);a=this.Ea("waffle-assistant-table-canvas");var b=this.Ea("waffle-assistant-canvas-container");DOf(this.V,a,b,this.C,this.D,this.L);a=this.Ea("waffle-tables-popup");
ky(a,"waffle-tables-popup-answers-enabled",this.xa);b=new nC(a,this.oa());this.qa(b);oC(b);a.focus()};JOf.prototype.ma=function(){this.dispatchEvent("Md")};JOf.prototype.Ba=function(){var a=OG(this.C);switch(this.D){case 0:a=Bn(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=Bn(a.top,a.left+1,a.top+a.height,a.left+a.width)}var b=this.L-1,c=this.C.gb();this.dispatchEvent(new BOf(new Cn(c,a),b,this.D));this.dispatchEvent("Md")};
function KOf(a,b,c,d,e,f,h,k,l,n,q){GW.call(this,l,q);this.Wa=b;this.Za=c;this.Na=d;this.cb=n;this.Ha=e;this.Pa=h;this.L=new Hz("",new CR,this.oa());this.Fa(this.L);this.ma=new Hz("",new CR,this.oa());this.Fa(this.ma);this.C=this.R=this.F=null;this.Sa=this.Za.L.C;this.Ba=Dz(yz(new xz,66));this.Ja=f;this.xa=new bW(f,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.qa(this.xa);this.Oa=Pg(l,4);this.D=null}t(KOf,GW);m=KOf.prototype;m.kI=ea(!0);
m.Aa=function(){GW.prototype.Aa.call(this);HW(this).appendChild(Ty(hNf));$_e(this).appendChild(Ty(iNf))};
m.Ga=function(){var a=this;GW.prototype.Ga.call(this);var b=C(this.H,5);b=o1e(this.Pa,b);this.R=new w1e(b,this.Sa,this.cb);b=this.Ea("waffle-assistant-insert-pivottable-button");this.L.Va(b);DW(b,"Insert Pivot Table");b=this.Ea("waffle-assistant-zoom-button");this.ma.Va(b);DW(b,"Preview Pivot Table");this.getHandler().listen(this.L,"action",function(){LOf(a,35619)}).listen(this.ma,"action",this.GVa);this.Jw(this.Rd())};
m.YB=function(a){var b=this.oa();b.Ne(this.Ea("waffle-assistant-answercard-interpret"),Qg(this.H,3));this.C=b.Aa("CANVAS","waffle-pivottable-pivot-canvas");b.Pi(this.C,!0);Vx(this.C,"Pivot table canvas");var c=this.Ea("waffle-assistant-answercard-pivot-content");b.appendChild(c,this.C);b=C(this.H,5);this.D=new v1e(c,this.Ja,this.Wa,this.Na);this.D.H=b;c=this.Rd();this.D.F=c;this.getHandler().Hf(this.C,Ko,this.GVa).listen(this.C,"mousedown",this.FVa).Rc(this.D,"pivot_inserted",this.pWb);x1e(this.R,
this.C);a()};m.pWb=ba();m.Jw=function(a){GW.prototype.Jw.call(this,a);if(this.L&&this.sb()){this.L.setVisible(!a);var b=this.oa().Ea("waffle-assistant-button-separator",$_e(this));P(b,!a)}this.F&&A1e(this.F,this.Rd());this.D&&(a=this.Rd(),this.D.F=a)};m.KC=function(){Vx(this.Ka(),"Suggested Pivot Table-"+Qg(this.H,3))};m.rD=ea("assistantPivotTableFeedback");m.$G=ea(2632);m.ZG=ea(2631);
function LOf(a,b){Kg(a.H,5)&&z(y(),"fewt")&&Apa(C(a.H,5),1);var c=new B1e(null,C(a.H,5),function(){a.dispatchEvent("close-sidebar");a.Ha.C(b,a.Ba)});OJ.dispatchEvent(c)}m.GVa=function(){var a=this;this.Ha.C(35620,this.Ba);this.F=new z1e(this.R,Qg(this.H,3),function(){LOf(a,35621)},function(){a.FVa()},this.oa());this.F.render();this.qa(this.F);A1e(this.F,this.Rd())};m.FVa=function(){this.C&&this.C.focus()};m.fS=function(){GW.prototype.fS.call(this);ETe(this.xa,io(this.Oa))};
m.mM=function(){GW.prototype.mM.call(this);aW(this.xa)};function MOf(a,b,c,d,e,f,h,k,l){q_.call(this,1,f,e,l);this.H=d;this.Ba=b;this.Da=c;this.F=h;this.Ha=k;this.J=Dz(yz(new xz,10));a=new CO(a,!0,!0);this.O=new k1e(a);this.D=null}t(MOf,q_);m=MOf.prototype;m.getTitle=ea("Pivot Table");m.V0=function(a){return 1==a};
m.nV=function(a){var b=C(a,1);switch(b){case 1:return new KOf(this.D,this.Ba,this.Da,this.H,this.R,this.F,this.O,this.J,a,this.Ha,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};m.gS=function(a,b){C(a[0],5)&&(this.D=b?b:null,q_.prototype.gS.call(this,a,b))};m.o6=ea(5);function NOf(){var a=null,b=new oq(function(){null!==a&&cq(a)});a=bq(function(){b.callback()});return b}function OOf(a,b,c){Oo.call(this);this.C=Xpc(YM.getInstance(),a,b,c);this.D=tq()}t(OOf,Oo);
OOf.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!Yc(c,function(f){return cBa(f,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].Ji()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&gTe(this.C),this.D=NOf(),qq(this.D,function(){return ITe(d.C,b,!0)}))};
function POf(a,b,c){b=c||b;a=a.v5b;c='<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+R(OA({content:"INSERT CHART",style:4,dd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"},b));c+=R(OA({dd:"waffle-autovis-lightbox-close",content:Dx(""+R(gC({icon:"docs-icon-img docs-icon-close-white"},b))),style:4,title:"Close"},b));c+='</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">';
var d='aria-label="'+Fx("Previous chart");d+='"';c+=R(OA({content:Dx("&#10094;"),style:4,dd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:Ex(d)},b));c+='<div class="goog-inline-block waffle-autovis-lightbox-container"></div>';d='aria-label="'+Fx("Next chart");d+='"';c+=R(OA({content:Dx("&#10095;"),style:4,dd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:Ex(d)},b));c+='</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
R(a)+"</div></div></div>";return T(c)}function QOf(){return T('<div class="waffle-autovis-lightbox-chart"></div>')}function ROf(a,b,c,d,e){Q.call(this,e);this.F=a;this.D=b;this.V=c;this.R=d;this.H=[];this.C=new PA("",this.oa());this.Fa(this.C);this.O=new PA("",this.oa());this.Fa(this.O);this.L=new PA("",this.oa());this.Fa(this.L);this.J=new PA("",this.oa());this.Fa(this.J)}t(ROf,Q);m=ROf.prototype;m.Aa=function(){Q.prototype.Aa.call(this);this.jb(Ty(POf,{v5b:this.F.length}))};
m.Ga=function(){Q.prototype.Ga.call(this);var a=Bsb.isEnabled();SOf(this,!a);a=this.Ea("waffle-autovis-lightbox-close");this.C.Va(a);a=this.Ea("waffle-autovis-lightbox-insert");this.O.Va(a);var b=this.Ea("waffle-autovis-lightbox-previous");this.L.Va(b);b=this.Ea("waffle-autovis-lightbox-next");this.J.Va(b);TOf(this);UOf(this,this.D,!1);this.getHandler().listen(document.body,"focusin",this.CWb).listen(this.Ka(),"keydown",this.DWb).listen(cp(),"resize",this.GWb).listen(this.C,"action",this.close).listen(this.O,
"action",this.fzb).listen(this.L,"action",this.FWb).listen(this.J,"action",this.EWb);b=new nC(this.Ka(),this.oa());oC(b);this.qa(b);a.focus()};function TOf(a){var b=a.Ea("waffle-autovis-lightbox-content"),c=a.Ea("waffle-autovis-lightbox-content-inner");a=a.Ea("waffle-autovis-lightbox-page-count");var d=bp();a=cx(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;$w(c,d,e);$w(b,d,e+a.height+35)}function SOf(a,b){ky(a.Ka(),"waffle-autovis-lightbox-readonly",b)}
function UOf(a,b,c){c&&QJ("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?VOf(a,b):a.F[b]&&(z(y(),"fecpmr")?(c=a.F[b].createChartModel(),WOf(a,c,b)):LNf(a.F[b],function(d){if(!a.isDisposed()&&d){var e=d.Qe();e=e?e.toJSON():null;var f=ritz.charts.model.GvizChart.create();f.updateChartWrapperJsonString(d.toJSON());e&&f.updateDataTableJsonString(e);WOf(a,f,b)}},!0))}function WOf(a,b,c){var d=a.Ea("waffle-autovis-lightbox-container"),e=Ty(QOf);d.appendChild(e);a.H[c]=e;I3e(b,e,a.V,a.R);VOf(a,c)}
function VOf(a,b){P(a.H[a.D],!1);P(a.H[b],!0);a.L.Ma(0!=b);a.J.Ma(b!=a.F.length-1);var c=a.Ea("waffle-autovis-lightbox-page-number");Ap(c,b+1);a.D=b}m.CWb=function(a){!yp(this.Ka(),a.target)&&a.relatedTarget&&a.relatedTarget.focus()};m.DWb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&UOf(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||XOf(this);a.stopPropagation()};
m.GWb=function(){var a=this.Ea("waffle-autovis-lightbox-container");op(a);this.H=[];TOf(this);UOf(this,this.D,!0)};m.fzb=function(){this.close();ONf(this.F[this.D],2256)};m.FWb=function(){0!=this.D&&UOf(this,this.D-1,!0);0==this.D&&this.J.Ka().focus()};m.EWb=function(){XOf(this);this.D==this.F.length-1&&this.L.Ka().focus()};function XOf(a){a.D!=a.F.length-1&&UOf(a,a.D+1,!0)}m.close=function(){this.dispose()};m.vd=function(){Q.prototype.vd.call(this);var a=this.F[this.D];a&&a.Ka()&&a.Ka().focus()};
function YOf(a){var b=a.name;a='<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+U(a.title)+'">'+R(b)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="';a+=Fx("Press enter to insert formula");return T(a+'"></span></div>')}function ZOf(a,b){Q.call(this);this.C=a;this.D=b}t(ZOf,Q);m=ZOf.prototype;m.Aa=function(){var a=Ty(YOf,{name:this.C,title:this.D});this.jb(a)};
m.Ga=function(){Q.prototype.Ga.call(this);var a=this.Ea("waffle-assistant-quicksum-entry-name");DW(a);this.getHandler().listen(this.Ka(),"keypress",this.IVb);P(this.Ka(),!1)};m.getFunctionName=g("C");m.setValue=function(a){Ap(this.Ea("waffle-assistant-quicksum-entry-value"),a||"");P(this.Ka(),!!a)};m.isVisible=function(){return fx(this.Ka())};m.IVb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new Ao("insert",this)))};
function $Of(a,b,c,d,e){Q.call(this,e);this.Ha=a;this.Da=b;this.L=c;this.O=d;this.D=a.C;this.ma=Dz(yz(new xz,17));this.V=Dz(yz(new xz,2));this.R=!1;this.F=[];this.C=this.J=null;this.H=[]}t($Of,Q);
$Of.prototype.Ga=function(){Q.prototype.Ga.call(this);this.Ff(new ZOf(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Ff(new ZOf(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Ff(new ZOf(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Ff(new ZOf(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Ff(new ZOf(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=
new i1e(this.Ka(),this.Da,this.D,this.L);this.C.F=this.R;this.qa(this.C);this.getHandler().listen(this,"insert",this.xa).listen(this.C,"formula_inserted",this.Ba)};
$Of.prototype.refresh=function(a){function b(l){return h&&null!=l?ritz_api.RitzModelApi.renderNumberAsFormattedString(l,xl(k,Uf)):null}if(JI(this.D)){if(null==a){var c=MI(this.D),d=oJ(c);a=GI(this.D);if(!Xc(d,c.Sq,c)){P(this.Ka(),!1);return}c=[];for(var e=0;e<d.length;e++){var f=d[e];f=lSb(a,f.tc(),f.rc(),f.Vc(),f.Wc());c.push(f)}a=c}d=[];this.F=[];for(c=0;c<a.length;c++)e=a[c],this.F.push(OG(e)),d.push(e.qb());a=a[0].gb();this.J=null;a!=GI(this.D)&&(this.J=(a=AI(this.D,a))?a.ue():null);if(d=ritz_api.RitzModelApi.quickSum(d)){P(this.Ka(),
!0);a=d.count;c=d.countNumberFormat;var h=1<d.numericCount,k=h?d.valueNumberFormat:null;this.Cc(0).setValue(b(d.sum));this.Cc(1).setValue(b(d.average));this.Cc(2).setValue(b(d.min));this.Cc(3).setValue(b(d.max));1<a?this.Cc(4).setValue(ritz_api.RitzModelApi.renderNumberAsFormattedString(a,xl(c,Uf))):P(this.Ka(),!1);if(this.C){this.C.R=[];this.H=[];for(d=0;d<this.zc();++d)a=this.Cc(d),this.H.push(aPf(this,a.getFunctionName()));j1e(this.C,this.H)}}else P(this.Ka(),!1)}else P(this.Ka(),!1)};
$Of.prototype.xa=function(a){var b=a.target;a=this.F[0];a=new Km(a.left,a.Vc());b=b.getFunctionName();b=aPf(this,b);a=new ztd(MI(this.D),fn(a),b);this.L.C(a);this.O.C(2624,this.V)};$Of.prototype.Ba=function(){this.O.C(2624,this.ma)};function aPf(a,b){var c=a.Ha.L.D,d=a.J;a=Uc(a.F,function(e){return IM(e,d)});return"="+b+"("+a.join(c)+")"}
function s_(a,b,c,d,e,f,h){QW.call(this,h);this.Sa=a;this.Ib=b.C;this.Ve=XM(b);this.Ba=c;this.yd=d;this.J=f;this.Wd=e;this.Ja=new $Of(b,c,d,f,this.oa());this.Fa(this.Ja);this.L=null;this.rb=this.qc=!1;this.ib=!0;this.Gd=Tk();this.Rb=this.cb=this.Za=null;this.Ha=Dz(yz(new xz,10))}t(s_,QW);m=s_.prototype;m.Aa=function(){QW.prototype.Aa.call(this);this.jb(Ty(bPf,{vT:this.Ve}))};
m.Ga=function(){QW.prototype.Ga.call(this);var a=this.Ea("waffle-assistant-quicksum-panel");this.Ja.Va(a);a=this.Ea("waffle-assistant-spinner-container");this.Ae.render(a);a=this.Ae;a.C="#4285f4";a.sb()&&U_e(a);a=this.Sa.C;this.getHandler().listen(this,"close-sidebar",this.Xta).listen(a,"recommender-load-started",this.Gta).listen(a,"recommender-load-ended",this.Fta).listen(a,"recommender-calc-started",this.Ysa).listen(a,"recommender-calc-ended",this.Xsa).listen(this.Ea("waffle-assistant-scroll-pane"),
"scroll",mUe(this.Fga,10,this));a=Bsb.isEnabled();this.Ega(!a)};m.resize=function(){var a=this.Ea("waffle-assistant-sidepane-content");a=cx(a).height;var b=this.Ea("waffle-assistant-spinner-container");Ow(b,"margin-top",a/2-16+"px");this.Fga()};m.EVa=ba();function cPf(a,b){var c=dPf(a);0!=c.length&&(Jf(a.L),c=c.filter(function(d){return d instanceof JNf}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.L=new ROf(c,b,a.Wd,a.J,a.oa()),a.L.render(),a.qa(a.L),SOf(a.L,a.rb)))}
m.Ega=function(a){this.rb=a;ky(this.Ka(),"waffle-assistant-readonly",a);var b=this.Ja;b.R=a;b.C&&(b.C.F=a);ky(b.Ka(),"waffle-assistant-quicksum-panel-readonly",a);this.L&&!this.L.isDisposed()&&SOf(this.L,a)};
m.setVisible=function(a){var b=this.isVisible();QW.prototype.setVisible.call(this,a);if(a&&!b){var c=nTe(this.Sa.C,a);c?(b=new L5d,L(b,1,yn(c,"r")),L(b,2,yn(c,"c")),L(b,3,c.Ji()),c=new rk,Oj(c,4,b),b=Dz(Cz(Ez(this.Ha),c))):b=this.Ha;this.cb=Uk(this.Gd,"sett",!1,b);this.Ae.setActive(!0);ePf(this)}a||fPf(this,!0)};m.Gta=function(){this.isVisible()&&(fPf(this,!0),this.Ae.setActive(!0))};m.Fta=function(){this.isVisible()&&this.Ae.setActive(!1)};
m.Ysa=function(a){this.isVisible()&&(this.J.C(2775,this.Ha),fPf(this,void 0,a.C,a.D),gPf(this)||this.Ae.setActive(!0),ePf(this),this.ib=!1)};
m.Xsa=function(a){if(this.isVisible()){this.J.C(2776,this.Ha);var b=a.C;0<b.length&&(this.Za=Uk(this.Gd,"serr"));fPf(this,!1);this.Ae.setActive(!1);a=a.D;var c=BV(this.Sa.C),d=this.V.C.getActiveGrid();c=!!c&&!!d&&c.gb()!=d.gb();d=ja(this.D);for(var e=d.next();!e.done;e=d.next()){e=e.value;for(var f=[],h=ja(b),k=h.next();!k.done;k=h.next()){k=k.value;var l=Qg(k,1),n;if(!(n=!e.V0(l))&&(n=c)){a:switch(l){case 2:case 4:case 6:l=!1;break a;default:l=!0}n=!l}n||f.push(k)}0<f.length?e.gS(f,a):e.hS(!0)}b=
ja(b);for(a=b.next();!a.done;a=b.next())if(a=a.value,5==Qg(a,1)){this.A$();this.Da=C(a,12);this.H=(c=PV(a))?AV(go(c)):null;this.xa=C(a,11);hPf(this);a=this.H;c=!1;for(d=this.Na.length-1;0<=d;d--)e=this.Na[d],f=a,Kn(e,1)&&e.gb()==f.gb()&&TMf(KG(e),KG(f))&&TMf(LG(e),LG(f))&&(c=!0,this.Na.splice(d,1));this.Na.push(a);a=c;2!=this.Da||a||iPf(this,!0)}b=dPf(this);0<b.length&&this.qc&&(b[b.length-1].ye=!0);this.qc=!1;ePf(this);jPf(this);this.Fga()}};
function ePf(a){var b=gPf(a),c=fx(a.Ea("waffle-assistant-quicksum-panel")),d=a.Ae.Vb();b=b||c||d;c=a.Ea("waffle-assistant-empty-list");P(c,!b);P(a.Ae.Ka(),b)}m.Qc=ba();m.hAa=ba();m.Rd=g("rb");m.Xta=ba();m.tQb=function(){this.Za&&(this.Za.complete(),this.Za=null);this.cb&&(this.cb.complete(),this.cb=null);this.Rb=Na();this.ib||(this.J.C(2777,this.Ha),this.ib=!0)};
function kPf(){return T('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+R(Xrc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+R("Explore")+"</div></div>")}
function bPf(a,b,c){b=c||b;a=a||{};c=T;var d=Dx('<div class="waffle-assistant-replaceable-title">'+kPf(null,b)+"</div>");var e=e=a||{};e=e.vT;var f='<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+R(Xrc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">';f+='Get insights instantly</div><div class="waffle-assistant-empty-list-body">';f=(e?f+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
f+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.")+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more';f+='</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">';f+="Try it out";f+="</a></div></div></div>";e=T(f);e=T('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
(e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return c(R(lX(Ax({title:d,bl:Dx(""+e),id:"autovis",Vw:"waffle-assistant-sidepanel",Pja:"waffle-assistant-title",mV:"waffle-assistant-sidepane-content"},a),b)))}
function lPf(a,b,c,d,e,f,h,k,l,n){r_.call(this,a,WAb,d,e,f);var q=this;this.Ja=n;this.Za=b;this.Ha=d;this.kb=e;this.rb=f;a=OG(d);this.J=IM(a);this.O=d.gb();this.Oa=new COf(b,c);this.qa(this.Oa);this.H=this.F=null;this.xa=h;this.V=sC(new rC);this.qa(this.V);this.Da=new Hz("",new CR,this.oa());this.Fa(this.Da);KA(this.V,this.Da,YAb);this.Ba=new Hz("",new CR,this.oa());this.Fa(this.Ba);KA(this.V,this.Ba,WAb);b=this.R.C.C.ue();this.ma=new $W(this.Za,function(r,w,x){mPf(q,r,w,x)},!1,"e.g., A2:D5",!0,b,
this.oa());this.Fa(this.ma);this.Na=null;this.Pa=new GA(this);this.qa(this.Pa);this.cb=k;this.ib=l}t(lPf,r_);m=lPf.prototype;m.Aa=function(){this.jb(Ty(FOf))};
m.Ga=function(){r_.prototype.Ga.call(this);this.Da.Va(this.Ea("waffle-tables-popup-done"));this.Ba.Va(this.Ea("waffle-tables-popup-cancel"));this.ma.render(this.Ea("waffle-assistant-tables-data-range-wrapper"));var a=this.Ea("waffle-range-selection-input");Sx(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().listen(a,"keydown",this.tWb).listen(a,"keyup",this.uWb).listen(a,"focusout",this.ZJb).listen(this.R.C,"xa",this.wWb).listen(this.ma,"change",this.vWb);this.Pa.subscribe(YAb,
"action",this.xWb).subscribe(WAb,"action",this.Jqb);nPf(this);a=this.Ea("waffle-tables-popup");ky(a,"waffle-tables-popup-answers-enabled",this.ib);var b=new nC(a,this.oa());this.qa(b);oC(b);a.focus()};m.Ia=function(){Jf(this.Na);r_.prototype.Ia.call(this)};function mPf(a,b,c,d){eW(a.cb,null,b,c,d,!1,void 0,function(e){a.Na=e})}
m.wWb=function(){for(var a=this.R.C,b=!0,c=ja(I_b(a)),d=c.next();!d.done;d=c.next())if((d=d.value)&&d.gb()==this.O){b=!1;break}b&&"number"===typeof FI(a)&&(this.O=FI(a),oPf(this,this.O));pPf(this)};function qPf(a){var b=a.Ea("waffle-assistant-table-canvas"),c=a.Ea("waffle-assistant-canvas-container");DOf(a.Oa,b,c,a.C,a.D,a.L)}m.Jqb=function(){this.dispatchEvent("Md")};
m.xWb=function(){var a=!Hnc.test(this.J);P(this.bb("waffle-assistant-tables-range-error"),a);ky(this.Ea("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.kb!=this.L||this.rb!=this.D;var b=!this.Ha.equals(this.C),c=this.Ha.gb()!=this.C.gb();if(a||b)a&&this.xa.C(35506),b&&this.xa.C(35507),c&&this.xa.C(35723),this.dispatchEvent(new BOf(NG(this.C),this.L,this.D,c));this.dispatchEvent("Md")}};
function nPf(a){var b=a.Ea("waffle-range-selection-input"),c=OG(a.Ha);a.J=IM(c);b.value=a.J;pPf(a);rPf(a);qPf(a)}m.Gga=function(a,b,c){r_.prototype.Gga.call(this,a,b,c);qPf(this)};
function sPf(a){var b=NI(a.R.C,a.O),c=b.$b(),d=Lnc(a.J,b),e=null!=d;if(e&&(b=S2b(b,d),e=An(b))){b=MG(b,c);var f=KG(b);c=LG(b);b=b.gb();d=bo(f);f=Kn(f,2)?Nn(f,2):ritz_api.RitzModelApi.getNumberOfRows(b);var h=bo(c);c=Kn(c,2)?Nn(c,2):ritz_api.RitzModelApi.getNumberOfColumns(b);c=lSb(b,d,h,f,c);a.Gga(c,tPf(a,c),a.D);pPf(a);rPf(a)}P(a.bb("waffle-assistant-tables-range-error"),!e)}function tPf(a,b){b=uPf(b,a.D);return a.L>b?b:a.L}
function uPf(a,b){a=0==b?a.Vc()-a.tc():a.Wc()-a.rc();return 0==a?3:Math.min(a-1,3)}
function pPf(a){if(a.Ja){P(Gp(a.oa(),"waffle-assistant-tables-data-range-label"),!1);Jf(a.H);var b=z(y(),"feuuc")?jH.getInstance():fue.getInstance();a.H=new wW(void 0,b);a.H.setContent("Data Range");a.Fa(a.H);KA(a.V,a.H,ZAb);a.H.render(a.Ea("waffle-assistant-tables-edit-sheet-button"));a.getHandler().listen(a.H,"action",a.dIb);b=0;for(var c=ja(I_b(a.R.C)),d=c.next();!d.done;d=c.next())if(d=d.value)d.gb()===a.O&&(b=a.H.Yh()),a.H.Uc(new Lz(d.ue(),d.gb()));a.H.Bf(b)}}
function rPf(a){Jf(a.F);a.F=new wW(void 0,jH.getInstance());a.Fa(a.F);KA(a.V,a.F,XAb);a.F.render(a.Ea("waffle-assistant-tables-edit-headers-button"));a.getHandler().listen(a.F,"action",a.cyb);for(var b=uPf(a.C,0),c=0;c<=b;c++){var d=(new wB("{NUM_HEADER_RECORDS, plural,=0 {No rows}=1 {1 row}other {# rows}}")).format({NUM_HEADER_RECORDS:c});a.F.Uc(new Lz(d))}c=uPf(a.C,1);for(d=0;d<=c;d++){var e=(new wB("{NUM_HEADER_RECORDS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_HEADER_RECORDS:d});
a.F.Uc(new Lz(e))}c=a.L;a.F.Bf(0==a.D?c:c+b+1);a.F.setContent("Headers")}m.ZJb=function(){var a=this.Ea("waffle-range-selection-input");this.J!=a.value&&(this.J=a.value,sPf(this))};m.vWb=function(){var a=this.ma.getValue();this.J=a;var b=this.Ea("waffle-range-selection-input");b.value=a;b.select();sPf(this)};m.dIb=function(){var a=this.H.getValue();a!=this.O&&(this.O=a,oPf(this,this.O));sPf(this)};
function oPf(a,b){if(a.Ja){var c=NI(a.R.C,b),d=jn(oJ(c));ritz_api.TablesApi.getTables(MG(d,b).qb(),function(e){if(e.length){var f=e[0];e=f.getDimensionTableAccessor().getHeaderRange();var h=OG(ao(ritz_api.RitzModelApi.toSerializedGridRangeProto(e)));e=f.getDimensionTableAccessor().getDimensionTagName();h=yn(h,0==e?"r":"c");f=OG(ao(ritz_api.TablesApi.getTableGridRange(f)))}else f=d,e=h=0;a.D=e;a.L=h;e=IM(f);a.J=e;e=a.Ea("waffle-range-selection-input");e.value=a.J;e.select();sPf(a)})}}
m.tWb=function(a){var b=this.Ea("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.J=b.value;sPf(this);YAb.pb();break;case 27:a.stopPropagation(),a.preventDefault(),nPf(this),WAb.pb()}};m.uWb=function(){this.J=this.Ea("waffle-range-selection-input").value;sPf(this)};m.cyb=function(){var a=this.F.Li(),b=uPf(this.C,0);this.Gga(this.C,a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};
function vPf(a,b,c,d,e,f,h,k,l,n,q,r){s_.call(this,a,b,c,e,d,f,r);this.Ad=n;this.Tc=h;this.V=b;this.Wa=new Q(this.oa());this.Fa(this.Wa);this.R=new F1e(q);this.qa(this.R);this.D=[];this.F=null;this.Oa=new PA("",r,4);lz(this.Oa,2,!1);this.Fa(this.Oa);this.Yc=k;this.Nc=l;this.H=null;this.Da=0;this.xa=null;this.kb=new Hz("",new CR,this.oa());this.Fa(this.kb);this.fc=new Q(this.oa());this.Fa(this.fc);this.Ec=sC(new rC);this.qa(this.Ec);KA(this.Ec,this.kb,$Ab);this.ma=this.O=null;this.Na=[]}t(vPf,s_);
m=vPf.prototype;
m.Ga=function(){var a=this;s_.prototype.Ga.call(this);this.Wa.Va(this.Ea("waffle-assistant-expanded-panel"));DW(this.C.Ka(),"Close");this.fc.Va(this.Ea("waffle-assistant-sidepane-tables-range"));hPf(this);this.kb.Va(this.Ea("waffle-assistant-tables-edit-range-button"));if(XM(this.V)){var b=new gOf(this.Tc,this.Ba,this.Ib,this.yd,this.J,this.R,this.V,this.Nc,this.Ad,this.oa());this.Fa(b);this.D.push(b)}b=new AOf(this.J,this.R,this.oa());this.Fa(b);this.D.push(b);z(y(),"feedvs")&&(b=new qOf(this.J,
this.R,this.Ba,this.oa()),this.Fa(b),this.D.push(b));b=new MOf(this.Tc,this.Ib,this.V,this.yd,this.J,this.R,this.Ba,this.Ad,this.oa());this.Fa(b);this.D.push(b);b=new eOf(this.Ib,this.Ba,this.Wd,this.J,this.R,this.oa());this.Fa(b);this.D.push(b);var c=this.Ea("waffle-assistant-features");Qc(this.D,function(d){d.render(c);a.Wa.Fa(d.C,!0)});this.Oa.Va(this.Ea("waffle-assistant-empty-list-learn-more"));this.getHandler().listen(this.Oa,"action",this.gWb).listen(this,"Md",this.A$).listen(this,"Ld",this.hWb);
wPf(this)};m.hWb=function(){var a=xPf(this);a&&(a.Oa=!0)};m.gWb=function(){(Rt(),Mv).pb(hue)};function jPf(a){Qc(a.D,function(b){$Nf(b)})}function fPf(a,b,c,d){Qc(a.D,function(e){e.hS(b,c,d)})}function gPf(a){return!!Yc(a.D,function(b){return b.iua()})}m.Fga=function(){var a=this,b=this.Ea("waffle-assistant-scroll-pane").scrollTop+cx(this.Ea("waffle-assistant-sidepane-content")).height;Qc(this.D,function(c){a.F&&a.F!=c||(c instanceof eOf&&a.getHandler().Rc(c,"Gd",a.tQb),b=c.p6(b))})};
function dPf(a){if(a.F)return a.F.C.C;var b=[];Qc(a.D,function(c){kd(b,ZNf(c))});return b}m.Ega=function(a){s_.prototype.Ega.call(this,a);wPf(this)};m.EVa=function(a){Qc(this.D,function(b){b.BVa(a)})};m.hAa=function(){var a=this.Ea("waffle-assistant-replaceable-title"),b=this.Ea("waffle-assistant-title");bx(b,cx(a).height)};
m.Qc=function(){var a=this,b=this.Ea("waffle-assistant-scroll-pane-feature-content"),c=this.Ea("waffle-assistant-replaceable-title"),d=this.Wa.Ka();if(this.F)this.F.C.setVisible(!1),this.F.setActive(!1),this.F=null,P(d,!1),P(b,!0),Ry(c,kPf),Tx(c,"label"),this.resize(),QJ("Explore Opened");else if(this.F=Yc(this.D,function(e){return e.Vb()}))P(b,!1),P(d,!0),this.F.C.setVisible(!0),aOf(this.F,c),Vx(c,this.F.getTitle()),b=this.F.getTitle()+" section expanded.",QJ(b);this.hAa();b=new Jq(function(){var e=
RC.vz();e&&e.dispatchEvent("resize");a.Fga()},300);this.qa(b);b.start()};m.setVisible=function(a){var b=this.isVisible();s_.prototype.setVisible.call(this,a);a&&!b&&yPf(this,!0);a||this.R.clear()};m.Xta=function(){s_.prototype.Xta.call(this);this.F&&this.Qc();this.A$()};m.Gta=function(){s_.prototype.Gta.call(this);yPf(this,!0)};m.Fta=function(){s_.prototype.Fta.call(this);yPf(this,!1)};m.Ysa=function(a){s_.prototype.Ysa.call(this,a);yPf(this,!0,a.C)};
m.Xsa=function(a){s_.prototype.Xsa.call(this,a);yPf(this,!1)};function zPf(a,b){var c=xPf(a);if(b){var d=z(y(),"feenas");a.O=new lPf(a.V,a.Ba,a.Yc,a.H,a.Da,a.xa,a.J,a.Nc,null!=c&&c.Vb(),d);a.Fa(a.O);a.O.render(a.getElement())}else a.O&&(a.removeChild(a.O,!0),Jf(a.O),a.O=null);c&&jOf(c,b)}function iPf(a,b){if(1!=a.xa){var c=xPf(a);b?(a.ma=new JOf(a.V,a.Ba,a.Yc,a.H,a.Da,a.xa,null!=c&&c.Vb()),a.Fa(a.ma),a.ma.render(a.getElement())):a.ma&&(a.removeChild(a.ma,!0),Jf(a.ma),a.ma=null);c&&jOf(c,b)}}
function wPf(a){Qc(a.D,function(b){b.iS(a.Rd())})}function xPf(a){return(a=Yc(a.D,function(b){return b instanceof gOf}))&&a}function yPf(a,b,c){Qc(a.D,function(d){d.Sn(b,c)});b&&(a.H=null,a.Da=0,a.xa=null,a.A$(),hPf(a))}
function hPf(a){var b=a.Ea("waffle-sidebar-tables-bar"),c=a.Ea("waffle-assistant-scroll-pane");var d=null;var e=z(y(),"feenas"),f=BV(a.Sa.C);if(a.H||e&&f){if(a.H){var h=OG(a.H);f=a.H.gb();e&&(d=AI(a.V.C,f).ue())}else h=f.Hc().C,d=f.ue(),a.H=MG(h,f.gb()),a.xa=0;d=IM(h,d);d=Ty(HOf,{zC:d});a=a.fc.Db();op(a);a.appendChild(d);P(b,!0);Zx(c,"waffle-assistant-tables-scroll-pane")}else P(b,!1),iy(c,"waffle-assistant-tables-scroll-pane")}m.A$=function(){zPf(this,!1);iPf(this,!1)};
function APf(a,b,c,d){A.call(this);this.H=a;this.D=b;this.J=c;this.$a=d||null}t(APf,TT);
APf.prototype.C=function(a){var b=this,c=[],d=new Lz("Suggestion is incorrect",null,this.$a);d.Lc("apps-menuitem");c.push(d);KA(a,d,this.H,void 0,function(){return BPf(b,"Suggestion is incorrect")},this.D);d=new Lz("Suggestion is not critical",null,this.$a);d.Lc("apps-menuitem");c.push(d);KA(a,d,this.H,void 0,function(){return BPf(b,"Suggestion is not critical")},this.D);d=new Lz("Other",null,this.$a);d.Lc("apps-menuitem");c.push(d);KA(a,d,this.H,void 0,function(){return BPf(b,"Other")},this.D);c.push(null);
d=Ty(M6e);d=new Lz(d,null,this.$a);d.Lc("apps-menuitem");c.push(d);KA(a,d,this.H,void 0,function(){return BPf(b,"Other")},this.D);return c};function BPf(a,b){return new XTe({description:b},a.J,a.D)}var CPf={Blc:"anomaly",m7a:"remove-duplicates",VIc:"number-format",u8a:"trim-whitespace"};
function t_(a,b,c,d){Q.call(this,d);var e=this;this.Wa=a;this.D=VJ(b);this.C=c;this.Ja=new bW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.qa(this.Ja);this.H=new bW(b,"waffle-assistant-mouseover-highlight-styled-border","waffle-assistant-mouseover-highlight-styled-rect");this.qa(this.H);this.Da=new bW(b,"waffle-assistant-mouseover-highlight-styled-border-red","waffle-assistant-mouseover-highlight-styled-rect-red");this.qa(this.Da);this.Ba=new PA;this.Fa(this.Ba);
this.O=new IA;this.qa(this.O);this.Pa=new jle(function(){return e.O},this.oa());this.qa(this.Pa);this.Sa=Dz(yz(new xz,76));this.J=null;this.xa={};this.Za=new GA(this);this.qa(this.Za);this.F=null;this.ma=new PA;this.Fa(this.ma)}t(t_,Q);m=t_.prototype;m.Aoa=function(a){a.Va(this.Ea("waffle-inline-assistant-ignore-button"))};
m.Ga=function(){var a=this;Q.prototype.Ga.call(this);var b=this.Ka();this.getHandler().listen(b,"mouseenter",this.I6).listen(b,"mouseleave",this.iha);DPf(this);if(b=this.bb("waffle-inline-assistant-suggestion-row-overflow-button"))this.Ba.Va(b),this.getHandler().listen(this.Ba,"action",this.b4b);this.Aoa(this.ma);KA(this.O,this.ma,lsb,LA,function(){return a},Dz(Cz(yz(new xz,76),this.G6())))};m.Ia=function(){Q.prototype.Ia.call(this);this.pN()};
m.I6=function(){u_(this,!0);aW(this.Ja);ETe(this.H,this.C);this.pN();this.f8()};m.iha=function(){u_(this,!1);this.pN();aW(this.H);this.Ka().blur()};m.b4b=function(){var a=this.Ea("waffle-inline-assistant-overflow-suggestions");P(a,!0);this.Ba.Ma(!1);this.Ba.setVisible(!1)};
function DPf(a){if(z(y(),"fedpsf")&&!a.F){a.F=new m7e(a.oa());a.Fa(a.F);var b=new APf(osb,a.Sa,a.xa,a.oa());lle(a.Pa,a.F.Qb(),[b]);b=a.Ea("waffle-assistant-card-feedback");a.F.render(b);a.F.setVisible(!1);a.getHandler().listen(a.F.Qb(),"afterhide",function(){a.F.setVisible(!1)})}}function EPf(a){return a.C.map(function(b){return b.rect})}function u_(a,b){a.F&&(b?a.F.setVisible(!0):b||a.F.Qb().isVisible()||a.F.setVisible(!1))}
function FPf(a,b,c,d,e,f){c.sort(function(h,k){return h.rect.top-k.rect.top});t_.call(this,a,b,c,f);this.Na=d;this.R=this.C.map(function(h){return IM(h.rect)});this.Oa=e;this.L=new kR(this.oa());this.Fa(this.L);this.Ha=new Q;this.Fa(this.Ha);this.V=new Q;this.Fa(this.V)}t(FPf,t_);m=FPf.prototype;m.G6=function(){var a=new rk;L(a,21,3);var b=new W5d;L(b,2,GPf(this.Na));Oj(a,26,b);return a};m.E6=ea("anomaly");
m.Aa=function(){var a=Ty(fNf,{vGa:this.R,abb:this.Oa});this.jb(a);a={};this.xa=(a.recommendationCategory="CATEGORICAL_ANOMALY",a.recommendationRange=this.R.join(","),a)};
m.Ga=function(){var a=this;t_.prototype.Ga.call(this);for(var b=this.Jg("jfk-textinput"),c=this.Jg("waffle-assistant-card-single-anomaly"),d=this.Jg("waffle-assistant-input-cell-chip"),e={},f=0;f<this.R.length;e={bU:e.bU,Hka:e.Hka,a9:e.a9},f++){var h=b[f];e.bU=this.R[f];var k=c[f];e.Hka=this.C[f];e.a9=d[f];this.getHandler().listen(h,["mousedown","click","mouseup","keydown"],function(l){return void l.stopPropagation()}).listen(h,"input",function(l){return function(){var n=a.Ea("waffle-assistant-input-container"+
l.bU);n.style.border="1.5px solid#188038";var q=$o("waffle-assistant-input-return-icon",n);P(q,!0);$o("waffle-assistant-input-cell-chip",n).style.color="#188038"}}(e)).listen(h,"focus",function(l){return function(){return HPf(a,l.bU)}}(e)).listen(h,"blur",function(l){return function(){return IPf(a,l.bU)}}(e)).listen(h,"keydown",function(l){return function(n){var q=l.bU;switch(n.keyCode){case 13:var r=a.D.Ra();n=a.Ea("waffle-assistant-input-container"+q);n=(n=$o("jfk-textinput",n))?n.value:null;if(a.L.isChecked()){q=
[];r=ja(a.C);for(var w=r.next();!w.done;w=r.next())(w=w.value)&&(q=q.concat(w.rect));ksb.pb({card:a,xGa:q,newValue:n})}else q=Lnc(q,r),ksb.pb({card:a,xGa:[q],newValue:n})}}}(e)).listen(k,"mouseenter",function(l){return function(){var n=l.Hka,q=l.a9;u_(a,!0);QP(a.D,n.rect.top,n.rect.left);a.L.isChecked()?ETe(a.H,a.C):dW(a.H,n);Zx(q,"waffle-assistant-input-cell-chip-hovered")}}(e)).listen(k,"mouseleave",function(l){return function(){var n=l.a9;u_(a,!1);aW(a.H);iy(n,"waffle-assistant-input-cell-chip-hovered")}}(e)).listen(this.L,
"change",function(){var l=a.bb("waffle-assistant-card-single-anomaly"),n=a.Jg("waffle-assistant-input-edit-icon");if(a.L.isChecked())for(P(a.V.Ka(),!0),Ow(l,"z-index","1000"),l.focus(),HPf(a,a.R[0]),l=0;l<n.length;l++)P(n[l],!1);else for(P(a.V.Ka(),!1),Ow(l,"z-index",""),l.blur(),l=0;l<n.length;l++)P(n[l],!0),IPf(a,a.R[l])})}this.V.Va(this.Ea("waffle-anomaly-grey-out"));P(this.V.Ka(),!1);this.Ha.Va(this.Ea("waffle-assistant-anomaly-apply-all-container"));1>=b.length&&P(this.Ha.Ka(),!1);this.L.Va(this.Ea("waffle-assistant-anomaly-apply-all-check"))};
m.Aoa=ba();function HPf(a,b){a=a.Ea("waffle-assistant-input-container"+b);a.style.border="1.5px solid#d93025";a.style.margin="0.5px 15.5px";b=$o("waffle-assistant-input-edit-icon",a);P(b,!1);a=$o("waffle-assistant-input-cell-chip",a);Zx(a,"waffle-assistant-input-cell-chip-hovered")}
function IPf(a,b){a=a.Ea("waffle-assistant-input-container"+b);a.style.border="";a.style.margin="";b=$o("waffle-assistant-input-edit-icon",a);P(b,!0);b=$o("waffle-assistant-input-return-icon",a);P(b,!1);a=$o("waffle-assistant-input-cell-chip",a);a.style.color="";iy(a,"waffle-assistant-input-cell-chip-hovered")}m.I6=function(){u_(this,!0);aW(this.Ja);var a=this.C[0];QP(this.D,a.rect.top,a.rect.left)};m.pN=ba();m.f8=ba();m.getColumnType=g("Na");
function GPf(a){switch(a.toUpperCase()){case "LOCATION":return 11;case "ADDRESS":return 12;case "PHONE NUMBER":return 13;case "COMPANY":return 14;case "FAMOUS PEOPLE":return 15;case "STOCK":return 16;case "DATETIME":return 7;case "EMAIL ADDRESS":return 9;default:return 0}}function JPf(a,b){a=ritz_api.TablesApi.getCurrentlyDetectedTables(UMf(a.$b()).qb());return a.length?Yc(a,function(c){return OG(ao(ritz_api.TablesApi.getTableGridRange(c))).intersects(b)}):null}function KPf(a){Rn.call(this,a)}
t(KPf,Rn);KPf.prototype.Fn=function(){return this.message.Fn()};KPf.prototype.oL=function(){return this.message.oL()};function LPf(a){this.Id=Dn(a,-1,0)}t(LPf,Hn);LPf.prototype.mf=function(){return new KPf(this)};LPf.prototype.Fn=function(){return this.ji(3,sSe)};LPf.prototype.oL=function(){return Kn(this,20)};function MPf(a){Rn.call(this,a)}t(MPf,Rn);MPf.prototype.getRange=function(){return this.message.getRange()};function NPf(a,b){return Yn(a,1,b)}function OPf(a,b){return Yn(a,2,b)}
function PPf(a){this.Id=Dn(a,-1,0)}t(PPf,Hn);PPf.prototype.mf=function(){return new MPf(this)};PPf.prototype.getRange=function(){return this.ji(1,$n)};function QPf(){var a=void 0===a?Jn(PPf):a;return new MPf(a)}function RPf(a){this.V=a;this.Ha=!1;this.L=[];this.xa=[];this.R=[];this.Da=[];this.O=[];this.Ba=[];this.C=[];this.H=[];this.J=[];this.F=this.D=this.ma=this.Ja=null}function SPf(a,b){a.J.push(b)}function TPf(a,b,c){a.J[c]=b}
function UPf(a,b,c,d,e,f){A.call(this);this.R=a;this.L=b;this.C=e;this.D=RV(this.L);this.O=new Jq(this.ma,void 0,this);this.qa(this.O);this.H=[];this.V=new Jq(this.xa,void 0,this);this.qa(this.V);this.F=[];this.J=[];VPf(this,f)}t(UPf,A);UPf.prototype.ma=function(){if(this.H.length&&this.J.length){var a=VJ(this.L);a&&(ritz_api.RitzModelApi.applyAnomalySetCellMutations(a.qp().gb(),this.H),sIc(a,this.J));this.H=[];this.J=[]}};
function VPf(a,b,c){if(z(y(),"fecad")){var d=PM(a.R);if(d){var e=c?[c]:ritz_api.RitzModelApi.getWorkbookRangesForSheet(a.D,12);c=[];var f={};e=ja(e);for(var h=e.next();!h.done;f={P_:f.P_},h=e.next()){var k=h.value,l=In(fYc,ritz_api.RitzModelApi.getWorkbookRangePropertiesDeltaProtoById(k));if(h=ritz_api.RitzModelApi.getWorkbookRangeById(k,!1))h=ao(h),h.gb()===d.$b()&&(h.tc()===h.Vc()||h.rc()===h.Wc()?c.push(k):(k=new dn(h.tc(),h.rc(),h.Vc(),h.Wc()),f.P_=new Cn(a.D,k),l=Qn(l.ji(11,EMf),4),k=ritz_api.RitzModelApi.getColumnType(h.gb(),
h.rc()),WPf(k,l)&&XPf(a,h,!1),k=a.C.C.findIndex(function(n){return function(q){return q.equals(n.P_)}}(f)),-1==k?(a.C.C.push(f.P_),a.C.H.push(l),SPf(a.C,ZI(d.Ug(h.tc(),h.rc()))),b.push(f.P_)):(a.C.H[k]=l,TPf(a.C,ZI(d.Ug(h.tc(),h.rc())),k))))}c&&YPf(a,c)}}}
function ZPf(a,b,c){if(a.D&&c){c=ja(c);for(var d=c.next();!d.done;d=c.next()){var e=a,f=b;d=d.value;if(!$Pf(e,f,d)){for(var h=[],k=e.C.C,l=e.C.H,n=e.C.J,q=[],r=[],w=[],x=0;x<k.length;x++){var F=k[x].rect;F.intersects(d)&&ZI(f.Ug(F.top,F.left))!==n[x]?(XPf(e,AV(k[x]),!0),aQf(e,h,k[x].rect)):(q.push(k[x]),r.push(l[x]),w.push(n[x]))}e.C.C=q;e.C.H=r;e.C.J=w;YPf(e,h)}}}}function WPf(a,b){if(null===a)return!1;a=In(Qzc,a);a=bQf(a.getType());return b.toUpperCase()===a}
function $Pf(a,b,c){if(ln(c))return!1;var d=a.C.C,e=a.C.H,f=a.C.J,h=Zc(d,function(X){return null!=hn(X.rect,c)});if(-1==h)return!1;b=b.$b();var k=ritz_api.RitzModelApi.getColumnType(b,d[h].rect.left);if(WPf(k,e[h]))return!1;k=[];var l=[],n=[],q=[];h=[];for(var r=[],w=0;w<d.length;w++)if(d[w].rect.intersects(c)){var x=AV(d[w]),F=XPf(a,x,!0,!1),M=d[w].rect;aQf(a,q,M);h.push(M);F&&r.push(x)}else k.push(d[w]),l.push(e[w]),n.push(f[w]);a.C.C=k;a.C.H=l;a.C.J=n;YPf(a,q);0<r.length&&ritz_api.RitzModelApi.applyAnomalySetCellMutations(b,
r.map(function(X){return cQf(!0,X)}));(a=VJ(a.L))&&sIc(a,h);return!0}function YPf(a,b){b.length&&(a.F=a.F.concat(b),a.V.start(100))}UPf.prototype.xa=function(){this.F.length&&(ritz_api.RitzModelApi.applyDeleteWorkbookRangeMutations(this.F,12),this.F=[])};function aQf(a,b,c){if(a=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(a.D,c.top,c.left,c.top+c.height,c.left+c.width,12,!1))for(a=ja(a),c=a.next();!c.done;c=a.next())b.push(c.value)}
function XPf(a,b,c,d){d=void 0===d?!0:d;if(!z(y(),"fecis")||!z(y(),"fecad")||!ritz_api.RitzModelApi.getColumnType(b.gb(),b.rc()))return!1;var e=ritz_api.RitzModelApi.getCellAtNoFilter(b.gb(),b.tc(),b.rc());if(!e||ritz_api.RitzModelApi.isDataValid(e)==c)return!1;if(!d)return!0;c=cQf(c,b);a.H.push(c);a.J.push(OG(b));a.O.start(100);return!0}function cQf(a,b){var c=void 0===c?Jn(LPf):c;c=new KPf(c);a=Wn(c,13,a);a=Xn(a,2,1024);a=Sn(a);return Sn(OPf(NPf(QPf(),b),a)).qb()}
function bQf(a){switch(a){case 11:return"LOCATION";case 12:return"ADDRESS";case 13:return"PHONE NUMBER";case 14:return"COMPANY";case 15:return"FAMOUS PEOPLE";case 16:return"STOCK";case 7:return"DATETIME";case 9:return"EMAIL ADDRESS";case 1:case 2:case 4:return"NUMBER";case 3:return"CURRENCY";default:return"OTHER"}}function dQf(a,b,c,d,e){t_.call(this,a,b,[c],e);this.ib=d;this.L=C(d,1);this.Na=C(d,4);this.R=d.getPattern();this.cb=C(d,5);this.Oa=new vl;this.Ha=new PA;this.Fa(this.Ha);this.V=null}
t(dQf,t_);m=dQf.prototype;m.Ga=function(){var a=this;t_.prototype.Ga.call(this);this.Ha.Va(this.Ea("waffle-inline-assistant-nf-check"));KA(this.O,this.Ha,jsb,LA,function(){return a});var b=this.Ea("waffle-inline-assistant-recommendation-container");this.getHandler().listen(b,"mouseenter",this.EBb).listen(b,"mouseleave",this.HBb)};m.G6=function(){var a=new rk;L(a,21,1);L(a,22,this.R);L(a,24,this.Na);return a};m.E6=ea("number-format");
m.Aa=function(){var a=DM(this.C[0].rect.left),b=eQf(this,this.Na),c=eQf(this,this.L,this.R);b=Ty(WMf,{column:a,D$b:b,C$b:c,YOb:1===this.Na&&(2===this.L||4===this.L||3===this.L),wMb:1<this.cb});this.jb(b);b=fQf(this.L);c={};this.xa=(c.recommendationCategory="NUMBER_FORMAT",c.recommendationRange=a,c.recommendationType=b.toLocaleUpperCase(),c.recommendationPattern=this.R,c)};
function eQf(a,b,c){if(1===b)return"TEXT";var d=new Zg;d.setType(b);D(d,3,1);c&&d.setPattern(c);c=1000.12;if(5===b||6===b||7===b)c=39717.66597222222;return ritz_api.RitzModelApi.renderNumberAsFormattedString(c,xl(a.Oa.qb(d),Uf))}function fQf(a){switch(a){case 1:return"Text";case 2:return"Number";case 3:return"Percent";case 4:return"Currency";case 5:return"Date";case 6:return"Time";case 7:return"Date time";case 8:return"Scientific";default:return"Unknown"}}
m.EBb=function(){var a=this.C[0].rect;QP(this.D,Math.max(0,a.top-2),a.left);a=this.Ea("waffle-inline-assistant-gridrange-chip");Zx(a,"waffle-inline-assistant-gridrange-chip-hovered");dW(this.H,this.C[0]);a=a.childNodes[0];this.V=a.nodeValue;a.nodeValue="";this.ma.setVisible(!0)};m.Aoa=function(a){a.Va(this.Ea("waffle-assistant-input-reject-icon"))};
m.HBb=function(){var a=this.Ea("waffle-inline-assistant-gridrange-chip");iy(a,"waffle-inline-assistant-gridrange-chip-hovered");aW(this.H);a.childNodes[0].nodeValue=this.V;this.V=null;this.ma.setVisible(!1)};m.I6=function(){u_(this,!0);this.pN();this.f8()};m.iha=function(){u_(this,!1);this.Ka().blur();this.pN()};m.f8=function(){this.J=ritz_api.GridViewApi.previewRangeWithNf(this.D.O.H,AV(this.C[0]).qb(),this.Wa,this.L,this.R);sIc(this.D,[this.C[0].rect])};
m.pN=function(){this.J&&(ritz_api.GridViewApi.clearTransform(this.D.O.H,this.J),this.J=null,this.D.isDisposed()||sIc(this.D,[this.C[0].rect]))};function gQf(a){var b=new Zg;b.setPattern(a.R);b.setType(a.L);return b}function hQf(a,b,c,d){Q.call(this,d);this.H=a;this.C=b;a=ja(b);for(b=a.next();!b.done;b=a.next())this.qa(b.value);this.J=c;this.D=new Q(d);this.Fa(this.D);this.F=new PA;this.Fa(this.F)}t(hQf,Q);
hQf.prototype.Aa=function(){var a=this;Q.prototype.Aa.call(this);var b=Ty(dNf,{Zab:this.J,r5b:this.C.length-3});this.jb(b);this.D.Va(this.Ea("waffle-inline-assistant-sidebar-category-cards"));if("anomaly"===this.H)iQf(this).forEach(function(c){var d=Ty(eNf,{lZ:c.length,Cna:c[0].getColumnType()});a.D.Ka().appendChild(d);for(d=0;d<c.length;d++)a.D.Fa(c[d],!0)});else for(b=0;b<this.C.length&&3>b;b++)this.D.Fa(this.C[b],!0)};
function iQf(a){var b=new Map;if("anomaly"!==a.H)return b;for(var c=0;c<a.C.length;c++){var d=a.C[c],e=EPf(d)[0];if(b.has(e.left)){var f=b.get(e.left);f=f.concat(d);b.set(e.left,f)}else b.set(e.left,[d])}return b}hQf.prototype.Ga=function(){Q.prototype.Ga.call(this);this.F.Va(this.Ea("waffle-inline-assistant-sidebar-category-show-more-button"));3>=this.C.length?(this.F.Ma(!1),this.F.setVisible(!1)):this.getHandler().listen(this.F,"action",this.L)};
hQf.prototype.L=function(){for(var a=this.D.zc();a<this.C.length;a++)this.D.Fa(this.C[a],!0);this.F.Ma(!1);this.F.setVisible(!1)};function jQf(a,b,c,d,e){t_.call(this,a,b,[c],e);this.Oa=d;this.L=Pg(d,5).concat(Pg(d,6));this.Ha=C(d,2);this.V=C(d,3);this.Na=C(d,4);this.R=new PA;this.Fa(this.R)}t(jQf,t_);m=jQf.prototype;m.G6=function(){var a=new rk;L(a,21,4);return a};m.E6=ea("remove-duplicates");
m.Ga=function(){var a=this;t_.prototype.Ga.call(this);for(var b=this.Jg("waffle-inline-assistant-recommendation-container"),c={wO:0};c.wO<this.L.length;c={wO:c.wO},c.wO++){var d=b[c.wO];this.getHandler().listen(d,"mouseenter",function(e){return function(){var f=e.wO,h=a.Jg("waffle-inline-assistant-gridrange-chip")[f],k=a.L[f],l=new Cn(a.C[0].C,new dn(k,a.Ha,k+1,a.V));0===f?dW(a.H,l):dW(a.Da,l);a.D.hK(k);Zx(h,"waffle-inline-assistant-gridrange-chip-hovered")}}(c)).listen(d,"mouseleave",function(e){return function(){var f=
e.wO;f=a.Jg("waffle-inline-assistant-gridrange-chip")[f];aW(a.H);aW(a.Da);iy(f,"waffle-inline-assistant-gridrange-chip-hovered")}}(c))}this.R.Va(this.Ea("waffle-inline-assistant-accept-button"));KA(this.O,this.R,msb,LA,function(){return a})};
m.Aa=function(){for(var a=IM(this.C[0].rect),b=this.D.Ra(),c=[],d=this.Ha;5>d&&d<this.V;d++){var e=b.Ug(this.L[0],d);c.push(ZI(e))}b=Ty(cNf,{X_a:this.L,aQ:c});this.jb(b);b={};this.xa=(b.recommendationCategory="REMOVE_DUPLICATES",b.recommendationRange=a,b.recommendationFirstRow=(this.L[0]+1).toString(),b)};m.I6=function(){u_(this,!0)};m.iha=function(){u_(this,!1);this.Ka().blur()};m.f8=ba();m.pN=ba();
function kQf(a,b,c,d,e){t_.call(this,a,b,c,e);this.V=d;this.R=Vc(Pg(d,1),function(f,h){return f+h},0);this.L=new PA;this.Fa(this.L)}t(kQf,t_);m=kQf.prototype;m.G6=function(){var a=new rk;L(a,21,2);return a};m.E6=ea("trim-whitespace");
m.Aa=function(){for(var a=this.C,b=[],c=[],d=ja(a),e=d.next();!e.done;e=d.next()){var f=e.value.rect;e=IM(f);var h=ZI(this.D.Ra().Ug(f.top,f.left));f=h.trimStart();var k=h.length-f.length,l=h.trim();f=f.length-l.length;h=[];for(var n=0;n<k;n++)h.push(null);k=!1;l=ja(l);for(n=l.next();!n.done;n=l.next())n=n.value,n.match("\\s")?k?(k=!1,h.push(null)):(k=!0,h.push(n)):h.push(n);for(k=0;k<f;k++)h.push(null);b.push(h);c.push(e)}b=Ty(ZMf,{jN:c,wGa:b});this.jb(b);a=DM(a[0].rect.left);b={};this.xa=(b.recommendationCategory=
"TRIM_WHITESPACE",b.recommendationRange=a,b.recommendationNumWhitespaces=this.R.toString(),b)};
m.Ga=function(){var a=this;t_.prototype.Ga.call(this);for(var b=this.Jg("waffle-inline-assistant-recommendation-container"),c={xO:0};c.xO<this.C.length;c={xO:c.xO},c.xO++){var d=b[c.xO];this.getHandler().listen(d,"mouseenter",function(e){return function(){var f=e.xO,h=a.C[f];dW(a.Da,h);QP(a.D,h.rect.top,h.rect.left);h=a.Jg("waffle-inline-assistant-gridrange-chip")[f];Zx(h,"waffle-inline-assistant-gridrange-chip-hovered");f=a.C[f];h=ritz_api.GridViewApi.previewRangeWithApplyTrimWhitespace(a.D.O.H,
AV(f).qb());a.J=h;sIc(a.D,[f.rect])}}(c)).listen(d,"mouseleave",function(e){return function(){var f=e.xO;aW(a.Da);var h=a.Jg("waffle-inline-assistant-gridrange-chip")[f];iy(h,"waffle-inline-assistant-gridrange-chip-hovered");a.J&&(ritz_api.GridViewApi.clearTransform(a.D.O.H,a.J),a.D.isDisposed()||(a.J=null,sIc(a.D,[a.C[f].rect])))}}(c))}this.L.Va(this.Ea("waffle-inline-assistant-accept-button"));KA(this.O,this.L,nsb,LA,function(){return a})};m.I6=function(){u_(this,!0)};
m.iha=function(){u_(this,!1);this.Ka().blur()};m.f8=ba();m.pN=ba();function lQf(a,b,c,d){Q.call(this,d);this.V=a;this.L=b;this.O=c;this.C=this.F=this.H=this.D=null;this.J=Ty(aNf);this.R=Ty($Mf)}t(lQf,Q);lQf.prototype.Aa=function(){Q.prototype.Aa.call(this);Zx(this.getElement(),"waffle-inline-assistant-sidebar-section")};lQf.prototype.Ga=function(){Q.prototype.Ga.call(this);this.Db().appendChild(this.J)};
function mQf(a,b,c){a.C&&(a.removeChild(a.C,!0),a.C.dispose());if(c.length){var d=VJ(a.L);if(d){var e=d.Ra();d=[];for(var f={},h=0;h<b.length;h++){var k=b[h],l=c[h],n=k.rect;n=H1b(e.Ug(n.top,n.left),e.$b(),n.top,n.left);var q=l+n,r=q in f?f[q].kFa:[];r.push(k);f[q]={Cna:l,cbb:n,kFa:r}}for(var w in f)b=f[w],b=new FPf(a.O,a.L,b.kFa,b.Cna,b.cbb),d.push(b);d.sort(function(x,F){x=EPf(x)[0];F=EPf(F)[0];return x.left!=F.left?x.left-F.left:x.top-F.top});a.C=new hQf("anomaly",d,"Fix invalid data");a.Fa(a.C)}}}
function nQf(a,b){var c=oQf(a,b.E6());c.D.removeChild(b,!0);var d=c.C.indexOf(b);c.C.splice(d,1);b.dispose();if(0===c.C.length)switch(b.E6()){case "number-format":a.D.dispose();a.D=null;break;case "trim-whitespace":a.H.dispose();a.H=null;break;case "remove-duplicates":a.F.dispose();a.F=null;break;case "anomaly":a.C.dispose(),a.C=null}}function pQf(a){var b=a.Db();Kf(a.qd(!0));b.contains(a.R)&&Jf(b.removeChild(a.R));a.C=null;a.F=null;a.D=null;a.H=null}
function qQf(a){return(a.C?a.C.C:[]).concat(a.F?a.F.C:[],a.D?a.D.C:[],a.H?a.H.C:[])}function oQf(a,b){switch(b){case "number-format":return a.D;case "trim-whitespace":return a.H;case "remove-duplicates":return a.F;case "anomaly":return a.C}}
function rQf(a,b,c){b=c||b;a=a||{};c='<div class="'+U("waffle-inline-assistant-sidebar-container")+'"><div class="'+U("waffle-inline-assistant-sidebar-column-filter-dropdown-container")+'"><div class="'+U("waffle-inline-assistant-sidebar-column-filter-dropdown")+'"></div></div><div class="'+U("waffle-inline-assistant-sidebar-empty-container")+'"><div class="'+U("waffle-inline-assistant-sidebar-empty-message")+'">';c=c+'No suggestions available</div></div><div class="'+(U("waffle-inline-assistant-sidebar-accepted-container")+
'"><div class="'+U("waffle-inline-assistant-sidebar-accepted-message")+'">');c=c+"Data cleanup suggestions have been applied</div>"+R(OA({dd:"waffle-inline-assistant-sidebar-accept-back",content:"Back",style:2},b));a=""+R(lX(Ax({title:"Data cleanup",bl:Dx(c+"</div></div>"),Ce:!0,id:"inlineassistant",Vw:"waffle-inline-assistant-sidebar",sF:Dx('<img class="docs-icon docs-auto-fix" aria-hidden="true" src="https://www.gstatic.com/images/icons/material/system/1x/auto_fix_black_24dp.png"/>'),JV:!0},a),
b));return T(a)}function sQf(a,b,c,d,e){QW.call(this,e);var f=this;this.L=b;this.R=d;this.D=new lQf(a,b,c,e);this.Fa(this.D);this.O=sC(new rC);this.qa(this.O);this.J=new PA;this.Fa(this.J);KA(this.O,this.J,Vsb);this.F=new wW(new Qz);tA(this.F,"All columns");this.Fa(this.F);KA(this.O,this.F,isb,this.F.J(),function(){return f.F.wf().getValue()});this.H=null}t(sQf,QW);
sQf.prototype.Ga=function(){var a=this;QW.prototype.Ga.call(this);this.getHandler().listen(this.Ka(),"click keyup keydown mousemove mouseover mouseenter mouseout".split(" "),function(){return void a.dispatchEvent("dataprep-sidebar-interaction-event")});C1e(this,!0);var b=this.Ea("waffle-inline-assistant-sidebar-empty-container");P(b,!1);b=this.Ea("waffle-inline-assistant-sidebar-accepted-container");P(b,!1);this.J.Va(this.Ea("waffle-inline-assistant-sidebar-insights-cta"));this.F.render(this.Ea("waffle-inline-assistant-sidebar-column-filter-dropdown"))};
sQf.prototype.Aa=function(){var a=Ty(rQf);this.jb(a);a=this.Db();this.D.render(a)};function tQf(a){if(null===a.H){var b=RV(a.L),c=VJ(a.L);a.H=ritz_api.GridViewApi.displayColumnErrorIcons(ritz_api.RitzModelApi.getTopLevelModel(),c.O.F,b);CTe(c)}}
sQf.prototype.setVisible=function(a){var b={};AB(this.R,(b.pe=a,b));this.isVisible()!==a&&(QW.prototype.setVisible.call(this,a),a?(C1e(this,!0),tQf(this)):(pQf(this.D),null!==this.H&&(a=VJ(this.L),ritz_api.GridViewApi.clearColumnHeaderTransform(a.O.F,this.H),this.H=null,CTe(a))))};
sQf.prototype.initialize=function(a,b,c,d,e,f,h,k,l){C1e(this,!1);pQf(this.D);var n=this.Ea("waffle-inline-assistant-sidebar-accepted-container");P(n,!1);n=this.Ea("waffle-inline-assistant-sidebar-empty-container");var q=this.Ea("waffle-inline-assistant-sidebar-column-filter-dropdown");if(a&&(b.length&&c.length||d.length&&e.length||f.length&&h.length||0!==k.length)){var r=new Qz,w=ao(ritz_api.TablesApi.getTableGridRange(a));a=w.rc();w=w.Wc();for(r.Fa(new Lz("All columns"),!0);a<w;a++)r.Fa(new Lz("Column "+
DM(a)),!0);r.setVisible(!1,!0);r.render();this.F.He(r);P(q,!0);P(n,!1);if(b.length&&c.length&&(n=this.D,n.D&&(n.removeChild(n.D,!0),n.D.dispose()),c.length)){q=[];for(r=0;r<c.length;r++)a=new dQf(n.O,n.L,b[r],c[r]),q.push(a);n.D=new hQf("number-format",q,"Apply format to columns");n.Fa(n.D)}if(d.length&&e.length&&(b=this.D,b.H&&(b.removeChild(b.H,!0),b.H.dispose()),e.length)){c=[];for(n=0;n<e.length;n++)q=new kQf(b.O,b.L,d[n],e[n]),c.push(q);b.H=new hQf("trim-whitespace",c,"Trim whitespace");b.Fa(b.H)}if(f.length&&
h.length&&(d=this.D,d.F&&(d.removeChild(d.F,!0),d.F.dispose()),h.length)){e=[];for(b=0;b<h.length;b++)c=new jQf(d.O,d.L,f[b],h[b]),e.push(c);d.F=new hQf("remove-duplicates",e,"Remove duplicate rows");d.Fa(d.F)}0!==k.length&&mQf(this.D,k,l);f=this.D;h=f.Db();!z(y(),"fects")&&5>=vMf(f.V).getValue()&&h.appendChild(f.R);f.F&&px(f.F,f.J);f.C&&px(f.C,f.J);f.D&&px(f.D,f.J);f.H&&px(f.H,f.J);tQf(this)}else P(n,!0),pQf(this.D)};function uQf(a,b,c){RJ.call(this,150);this.hb=a;this.F=b;this.C=c}t(uQf,RJ);
uQf.prototype.Kd=function(){for(var a=new nRb,b=0;b<this.C.length;b++){var c=this.C[b],d=this.F[b],e=new BG,f=this.hb.$b();d=fo(d,f);D(e,1,d);switch(c.H){case 32:c=c.Kd();D(e,7,c);break;case 134:c=c.Kd();D(e,4,c);break;case 138:c=c.Kd();D(e,3,c);break;case 1:c=c.Kd();D(e,2,c);break;case 151:c=c.Kd();D(e,6,c);break;case 55:c=c.Kd();D(e,5,c);break;default:continue}Ng(a,1,e)}return a};uQf.prototype.Cg=ea(!1);
function vQf(a,b,c,d,e){fW.call(this,a,c);this.C=a;this.F=b;this.D=d;this.H=e;this.J=new n7e(b,e,a);this.qa(this.J);a=new GA(this);a.Ob(Vsb,nt,this.jzb);this.qa(a)}t(vQf,fW);m=vQf.prototype;m.initialize=function(a,b,c,d,e,f,h,k,l){this.C.initialize(a,b,c,d,e,f,h,k,l)};m.show=function(){gW(this);this.C.setVisible(!0)};
m.iL=function(){var a=new rk;L(a,23,qQf(this.C.D).length);this.H.C(36588,Dz(Cz(yz(new xz,76),a)));a=ja(qQf(this.C.D));for(var b=a.next();!b.done;b=a.next())this.H.C(36583,Dz(Cz(yz(new xz,76),b.value.G6())));fW.prototype.iL.call(this)};function wQf(a,b){var c=PM(a.F);if(c){var d=EPf(b);a.D.C(new uQf(c,d,d.map(function(){return new jue})));nQf(a.C.D,b)}}m.jzb=function(){Jf(this.J);A5b(!0)};
function xQf(a,b,c,d){var e=PM(a.F);e&&(a.D.C(new uQf(e,c,c.map(function(f){return new nxd(e,new Km(f.left,f.top),d)}))),nQf(a.C.D,b))}m.isVisible=function(){return this.Vf().isVisible()};m.Vf=function(){return esb};m.Np=function(){return fsb};
function yQf(a,b,c,d,e,f,h,k,l,n,q,r,w){A.call(this);var x=this;this.F=a;this.O=b;this.Ha=c;this.Xa=d;this.Rb=e;this.Za=h;this.ib=k;this.ma=f;Xpc(this.ma,this.F,this.Rb,this.Xa);this.Ib=l;this.kb=n;this.qc=q;this.rb=r;this.fc=w;this.D=null;this.V=[];this.C=new RPf(null!=this.H);this.Ba=this.Sa=this.Oa=this.Da=!1;this.H=null;this.Wa=this.Pa=!1;this.J=RV(this.O);this.Ja=new Map;this.R=new Jq(this.xwa,void 0,this);this.qa(this.R);this.L=null;this.Ua=new Po(this);this.qa(this.Ua);this.xa=new UPf(a,b,
c,this.Ja,this.C,this.V,100,.95);this.Na=0;this.Ua.listen(this.O,"selectionChange",this.$3b).listen(this.O,"Rc",this.X3b,!0).listen(this.ma,"recommender-calc-ended",this.D6).listen(this.ma,"recommender-calc-failed",this.Eqb).listen(UG(this.F.C),"tb",this.EFb).listen(this.F.C,"na",this.a4b).listen(UG(this.F.C),"hc",this.YAb).listen(this.O,"inputBoxActivate",this.W3b).listen(this.O,"inputBoxDeactivate",this.Y3b).listen(UG(this.F.C),["wb"],this.mPa).listen(UG(this.F.C),["xb"],this.mPa).listen(this.rb.Ja,
"sheet-imported",this.Z3b);this.cb=new GA(this);this.qa(this.cb);this.cb.Ob(gD,nt,this.GAb).Ob(qsb,nt,function(){return zQf(x)}).Ob(psb,nt,this.BEb).Ob(msb,nt,this.TFb).Ob(jsb,nt,this.HCb).Ob(nsb,nt,this.PKb).Ob(ksb,nt,this.eJb).Ob(isb,nt,this.nsb).Ob(lsb,nt,this.zyb);AQf(this)}t(yQf,A);m=yQf.prototype;
m.TFb=function(a){a=a.data;var b=this.D,c=PM(b.F);if(c){var d=EPf(a)[0],e=new hh,f=d.rc();D(e,1,f);f=d.Wc();D(e,2,f);b.D.C(new p7e(c,d,[e],a.Na,a.L));nQf(b.C.D,a)}b=this.C.Ba;a=b.indexOf(a.Oa);0>a||(b.splice(a,1),this.C.O.splice(a,1),this.C.F=null,this.C.D=null)};m.HCb=function(a){a=a.data;var b=this.D,c=PM(b.F);if(c){var d=EPf(a);b.D.C(new uQf(c,d,[new iue(c,d[0],gQf(a))]));nQf(b.C.D,a)}b=this.C.xa;a=b.indexOf(a.ib);0>a||(b.splice(a,1),this.C.L.splice(a,1),this.C.F=null,this.C.D=null)};
m.PKb=function(a){var b=a.data;wQf(this.D,b);a=this.C.Da;b=a.indexOf(b.V);0>b||(a.splice(b,1),this.C.R.splice(b,1),this.C.F=null,this.C.D=null)};m.eJb=function(a){xQf(this.D,a.data.card,a.data.xGa,a.data.newValue)};
m.nsb=function(){var a=this.D.C.F,b=a.wf().getValue(),c=a.Ka();a=$o("docs-material-gm-labeled-select-outer-box",c);c=$o("docs-material-gm-labeled-select-caption",c);"All columns"===b?(zQf(this),Ow(a,"background-color",""),Ow(c,"color","")):(zQf(this,Nnc(b.slice(7))),Ow(a,"background-color","#E6F4EA"),Ow(c,"color","#188038"))};m.zyb=function(a){nQf(this.D.C.D,a.data)};function AQf(a){z(y(),"fedpsoi")&&a.fc&&(a.L=500,a.R.start(a.L),a.Sa=!0)}
function BQf(a,b){return a.J?b.filter(function(c){c=go(PV(c));return c.C!=a.J?!1:TM(a.F,c.C||a.J,c.rect,!1)}):[]}function CQf(a){Jf(a.H);a.H=null}m.Z3b=function(a){a=a.Xh;if(CI(this.F.C,a)){var b=new RPf(!1);this.Ja.set(a,b);a===this.J&&(this.C=b)}this.Ba=!0;AQf(this)};m.BEb=function(){CQf(this);var a=kC(this.qc,"See these suggestions also by using the toolbar menu Data -> Cleanup suggestions.",this.O.oa());a.render();a.setVisible(!0);DQf(this)};m.GAb=function(){this.Da=!0;this.xwa();EQf(this);DQf(this)};
function EQf(a){if(PM(a.F)){VPf(a.xa,a.V);if(!a.D){var b=new sQf(a.F.F,a.O,a.F.L.C,a.ib);a.qa(b);b.render();a.D=new vQf(b,a.F,a.Ib,a.kb,a.Ha);a.qa(a.D)}a.D.show()}}m.W3b=function(){this.Pa=!0;this.R.stop()};m.Y3b=function(){this.Pa=!1;if(null!=this.H||null!=this.D&&this.D.isVisible())this.L=null!=this.H?1E3:5E3,this.R.start(this.L)};
function zQf(a,b){a.Da=!1;a.Oa=!1;a.Sa=!1;CQf(a);DQf(a);var c=PM(a.F);if(c){var d=[];if(a.C.D&&(d=BQf(a,a.C.D.C),!a.J))return;var e=a.C.ma;e?e=JPf(c,e.rect):(e=JPf(c,c.F))&&NG(ao(ritz_api.TablesApi.getTableGridRange(e)));var f=[],h=[],k=[],l=[],n=[],q=[];d=ja(d);for(var r=d.next();!r.done;r=d.next()){var w=r.value;r=go(PV(w));if(void 0===b||r.rect.left==b||9===C(w,1))switch(a.V.push(r),C(w,1)){case 7:var x=r.rect.left;if(ritz_api.RitzModelApi.getColumnType(c.$b(),x))continue;w=C(w,14);x=C(w,1);var F=
w.getPattern();a:{var M=Fie(a.F.F.L);switch(x){case 4:case 5:case 6:case 7:M=ja(M);for(var X=M.next();!X.done;X=M.next())if(X=X.value.pE,X.getType()===x){F=Qg(X,2);break a}}}w.setPattern(F);l.push(w);f.push(r);break;case 8:r=C(w,15);n.push(r);h.push(Pg(w,4).map(go));break;case 9:w=C(w,16),q.push(w),k.push(r)}}r=a.C.C;w=a.C.H;c=[];d=[];if(void 0!==b)for(x=0;x<r.length;x++)r[x].rect.left==b&&(c.push(r[x]),d.push(w[x]));else c=r,d=w;EQf(a);a.D&&(r=vMf(a.F.F),r.setValue(r.getValue()+1),a.D.initialize(e,
f,l,h,n,k,q,c,d),void 0===b?a.D.C.F.Bf(0):a.D.C.F.Bf(b+1));a=a.C;a.Ja=e;a.L=f;a.xa=l;a.R=h;a.Da=n;a.O=k;a.Ba=q}}
m.a4b=function(){var a=RV(this.O);if(a&&this.J){this.C.V=null!=this.H;var b=null!=this.D&&this.D.isVisible();this.C.Ha=b;this.D&&(b=this.D,b.Vf().isVisible()&&b.iL());this.Ja.set(this.J,this.C);null!=this.H&&this.Ha.C(36590);CQf(this);this.V=[];this.Ba||(this.R&&this.R.stop(),this.L=null);this.J=a;this.C=this.Ja.has(a)?this.Ja.get(a):new RPf(!1);a=this.xa;b=this.J;var c=this.C,d=this.V;b&&c&&a.D&&(a.D=b,a.C=c,VPf(a,d));if(this.C.V){if(a=VJ(this.O))this.H=CMf(a,this.O,this.Za,this.C.ma,this.C.D?this.C.D.C:
[],this.C.C.length)}else if(this.C.Ha){a=this.C.Ja;b=this.C.L;c=this.C.R;d=this.C.O;var e=this.C.C;a&&(b.length||c.length||d.length||e.length)&&(EQf(this),this.D&&this.D.initialize(a,b,this.C.xa,c,this.C.Da,d,this.C.Ba,this.C.C,this.C.H))}}};m.mPa=function(){if(z(y(),"fecad")){var a=this.xa,b=this.V;a.C.C=[];a.C.H=[];a.C.J=[];VPf(a,b)}};
m.EFb=function(a){if(a.C){var b=PM(this.F);if(!b)if(a.target instanceof lJ)b=a.target;else return;var c=this.R.Vb()||null!=this.D&&this.D.isVisible(),d=b.F;a.C.some(function(e){return d.intersects(e)&&20<=e.height&&4<=e.width&&100<=e.height*e.width})?(this.Wa=!0,c&&this.R.start(500)):!this.Wa&&c&&(this.L=null!=this.H?1E3:5E3,this.R.start(this.L));ZPf(this.xa,b,a.C);b={};a=ja(a.C);for(c=a.next();!c.done;b={Z8:b.Z8},c=a.next()){b.Z8=c.value;if(!this.J)break;if(!this.C.F)break;if(cBa(this.C.F,b.Z8)&&
(!this.V||null!=this.H||!this.V.some(function(e){return function(f){return e.Z8.equals(f.rect)}}(b)))){this.C.F=null;this.V=[];null!=this.H?(this.L=1E3,this.R.start(this.L)):this.C.D=null;break}}}};m.$3b=function(){SM(this.F)&&!z(y(),"fedpsoi")&&(this.L=this.L||500,this.R.start(this.L))};m.X3b=function(){var a=PM(this.F);if(a){var b=sJ(a).x;$Pf(this.xa,a,new dn(0,b,a.Fg(),b+1,!1,!0));this.C.F=null;this.V=[];null!=this.H?(this.L=1E3,this.R.start(this.L)):this.C.D=null}};
m.Eqb=function(){2<this.Na?(this.Na=0,this.D6(null)):(this.Na++,this.xwa())};
m.D6=function(a){this.Ba=!1;this.Na=0;this.Wa=!1;if((z(y(),"fenfts")||z(y(),"fetws")||z(y(),"ferds")||z(y(),"fecad"))&&!this.Pa){var b=this.ma.C,c=VJ(this.O);if(this.J)if(a&&c&&b&&this.J&&b.C===this.J?(this.C.D=a,this.C.F=b.rect):(this.C.D=null,this.C.F=null),this.C.ma=b,this.Da||this.Oa)zQf(this);else{a=a?BQf(this,a.C):[];var d=this.C.C.length,e=a.length+d;if(!b||2>e)FQf(this);else if(!this.D||!this.D.isVisible()){for(var f=1<d,h=0,k=0,l=ja(a),n=l.next();!n.done;n=l.next())n=n.value,7==C(n,1)?(f=
f||C(C(n,14),3),h++):9==C(n,1)&&(f=!0,k++);f?0==k&&2>h?FQf(this):(null!=this.H?(c=this.H,c.J=b,zMf(c,a),c.H=d,b=IM(c.J.rect),b=z(y(),"feadpdp")?Ty(wMf,{Xf:b,tha:c.D,wha:c.F,uha:c.C,lZ:c.H}):Ty(xMf,{Xf:b,kYa:c.D+c.F+c.C+c.H}),a=c.Ea("waffle-assistant-popup-suggestion-text-container"),c.oa().qd(a),c.oa().appendChild(a,b)):this.Sa?(zQf(this),this.Ha.C(36702,GQf(this,e))):"MERGED"===Kc(y(),"fdpfs")&&z(y(),"fects")&&z(y(),"fecis")&&z(y(),"fecad")||z(y(),"fedpsoi")||(this.Ha.C(36324,GQf(this,e)),this.H=
CMf(c,this.O,this.Za,b,a,d)),this.C.V=null!=this.H):FQf(this)}}}};function FQf(a){null!=a.H&&(a.Ha.C(36589),CQf(a))}function GQf(a,b){var c=new rk;L(c,23,b);for(var d in CPf){b=new mT;switch(CPf[d]){case "number-format":L(b,1,1);L(b,2,a.C.L.length);break;case "trim-whitespace":L(b,1,2);L(b,2,a.C.R.length);break;case "remove-duplicates":L(b,1,4);L(b,2,a.C.O.length);break;case "anomaly":L(b,1,3);L(b,2,a.C.C.length);break;default:continue}Rj(c,25,b,mT,void 0)}return Dz(Cz(yz(new xz,76),c))}
function DQf(a){a.J&&uMf(a.F.F.J,a.F.D.D,a.J)}m.YAb=function(a){var b=this.xa,c=this.V;if(a&&a.L){var d=PM(b.R);d&&(a=a.L,a instanceof eYc&&a.H.gb()===d.$b()&&VPf(b,c,a.ql()))}};
m.xwa=function(){if(this.J){if(!this.Ba&&!this.Da&&!this.Oa){var a=this.F.F.J;if(!Gj(a.C,2,!0))return;var b=this.F.D.D;a=ja(Nj(a.C,AT,1));for(var c=a.next();!c.done;c=a.next())if(c=c.value,b===K(c,1)&&this.J===c.gb())return}this.L=null;b=PM(this.F);a=XJ(this.O);b&&!this.F.Rd()&&this.F.H.C&&!VM(this.F)&&a&&!a.F?(a=b.F,(c=this.C.F)&&cBa(c,a)?((this.Da||null!=this.H)&&this.D6(this.C.D),this.Ba=!1):vPe(this.ma)?(this.ma.reset(),gTe(this.ma),(b=JPf(b,a))?(b=ao(ritz_api.TablesApi.getTableGridRange(b)),
this.ma.L=b,qTe(this.ma,!0,!0,!1,[7,8,9])):this.D6(null)):this.D6(null)):this.Ba=!1}};function HQf(a,b,c,d,e,f,h,k,l,n,q){fW.call(this,b,h);var r=this;this.H=a;this.C=b;this.Da=c;this.Pa=d;this.Na=e;this.L=f;this.D=c.C;this.Ja=this.Ba=!1;this.F=null;this.V=k;this.Oa=q;this.J=null;IQf(this);Asb.Ma(!0);a=new gk;L(a,6,JQf());b=new bk;hk(b,a);this.ma=Dz(yz(zz(new xz,b),10));this.xa=-1;a=new Jq(function(){return KQf(r,!1)},100);this.qa(a);a.start()}t(HQf,fW);
function IQf(a){var b=UG(a.Na);a.La.listen(a.Pa,"selectionChange",a.jWb).listen(a.D,"na",a.iWb).listen(a.D,"xa",a.lWb).listen(b,"tb",a.EPa).listen(a.C,"Dd",a.Hpb).listen(a.C,"Cd",a.Gpb).listen(a.C,"Bd",a.Epb).listen(a.C,"Jd",a.PFb).listen(a.C,"Fd",a.arb).listen(a.C,"Nd",a.dJb).listen(a.C,"Kd",a.yHb).listen(a.C,"Ed",a.eqb).listen(a.C,"Od",a.mWb).listen(a.H.C,"recommender-confidence-update",a.Hsb).listen(a.C,"Ld",a.kWb);xt(xt(xt(xt(xt(xt(wt(a.O,Bsb,(qt(),rt),function(){a.C.Ega(!Bsb.isEnabled())}),Dsb,
function(){var c=a.C.isVisible();a.Vf().setVisible(!c);c||a.C.focus();LQf(a,!c)}),Csb,function(c){cPf(a.C,c.data)}),Yrb,function(){return MQf(a)}),cvb,function(c){return NQf(a,c.data)}),$Ab,function(){zPf(a.C,!0)}),sE,function(){return a.iL()})}m=HQf.prototype;m.Vf=function(){return Esb};m.Np=function(){return Fsb};m.iy=function(a){fW.prototype.iy.call(this,a);Csb.Ma(a);KQf(this,!1);!this.Ba&&a&&(this.Ba=!0);var b={};AB(this.Oa,(b.qe=a,b));a||this.C.Qc()};
m.h6=function(a){var b=this;this.C.hAa();var c=new Jq(function(){fW.prototype.h6.call(b,a)},300);this.qa(c);c.start()};m.iL=function(){fW.prototype.iL.call(this);LQf(this,!1)};m.DVa=function(a){this.C.EVa(a);this.H.C.Ja=a};m.Hpb=function(a){var b=a.C.H,c=C(C(b,13),3);b=PV(b);var d=new vh;Tge(d,c);var e=new nr;D(e,1,d);D(e,3,!0);hQe(e,!0);this.L.C(new u7e(e,b));v_(this,a.jk(),!1,N6e(th(c)))};function LQf(a,b){b?(v_(a,2253),a.xa=Na()):v_(a,2226,!0)}function MQf(a){a.C.isVisible()||a.iy(!0)}
function NQf(a,b){var c="",d=void 0;b&&b.evt&&(c=b.evt?b.evt.C:"",d=b.evt);var e=xPf(a.C);e&&(e.Vb()?mOf(e,c,!0,!!c,d):(MQf(a),b=new Jq(function(){lOf(e,c,!0,!!c,d)},1E3),a.qa(b),b.start()))}m.lWb=function(){BV(this.H.C)||(this.H.C.reset(),KQf(this,!1))};m.jWb=function(){if(SM(this.Da)&&null==this.C.O){var a=BV(this.H.C);a&&FI(this.D)!=a.gb()||KQf(this,!0)}};
function KQf(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.J&&c[0].equals(a.J)){a.J=null;return}}var d=a.C;d.isVisible()&&(d.Ja.refresh(void 0),ePf(d));a.H.update(!b,a.C.isVisible(),c)}
m.Hsb=function(a){var b=a.C,c=b?b.D:null;a=b?b.C:0;var d=!!b&&.9<=b.C,e=b?b.D.rect:null;e=!!e&&e.Ji()>=Epb&&yn(e,"r")>=Gpb&&yn(e,"c")>=Hpb&&e.Ji()<=Fpb;b=!!b&&.6<=b.C&&e;if(b!==this.Ja||c&&!c.intersects(this.F))this.Ja=b,this.F=c,this.xa=Na(),Asb.pb({Oea:b,zC:c});e&&c&&c.rect&&(b=1E3>=c.rect.Ji(),c=ritz_api.RitzModelApi.isFormsRegion(c.C,c.rect.top,c.rect.left,c.rect.height+c.rect.top,c.rect.width+c.rect.left),d=!this.C.isVisible()&&!this.Ba&&d&&b&&!eL(this.Da.H),c=z(y(),"feeaof")&&c,b=z(y(),"feeaoro")&&
this.Da.Rd(),d&&(c||b)&&(d=new gk,L(d,1,a),L(d,2,c),L(d,3,b),L(d,5,Jpb),L(d,6,JQf()),a=new bk,hk(a,d),a=Dz(zz(yz(new xz,10),a)),this.JFa(a)))};m.JFa=function(a){var b=this;if(JI(this.D)&&!BJ(MI(this.D))&&(this.C.qc=!0,!RC.jca().C)){var c=a||this.ma;this.Vf().setVisible(!0);this.V.C(2225,c);v_(this,2253);a=new Jq(function(){b.C.isVisible()||b.V.C(2752,c)},5E3);this.qa(a);a.start()}};
function JQf(){switch(Ipb){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}m.eqb=function(){this.C.Qc()};m.mWb=function(a){var b=a.C,c=PV(b.H);this.J=ho(c);Eje(this.L.D);xOf(b,c);v_(this,a.jk())};m.iWb=function(){JI(this.D)?(this.C.Ma(!0),this.H.C.reset(),KQf(this,!1)):(this.Vf().setVisible(!1),this.H.C.reset(),this.C.Ma(!1))};m.EPa=function(a){KQf(this,!1,GSb(a))};
m.Gpb=function(a){var b=MI(this.D),c=b.$b(),d=[],e=k7e(b);if(e){b=new Lr;var f=Qg(e,2);D(b,3,f);f=Qg(e,2);D(b,2,f);e=Qg(e,1);D(b,1,e);d.push(b)}b=a.C.Vd;for(e=0;e<b.length;e++)f=new Lr,D(f,2,b[e]),d.push(f);this.L.C(new t7e(d,c));v_(this,a.jk())};
m.Epb=function(a){var b=a.C,c=Z6e(b.C),d=PV(b.H),e=c.Gy?c.EB:null,f=c.C?c.lB:null,h=d.gb(),k=OQf(d);this.J=ho(d);k?(c=new w7e(k,h,this.J,e,c.ux,c.Cy,f),SJ(c,function(l){l&&a.D.call()}),this.L.C(c)):(c=new r7e(h,this.J,e,c.ux,c.Cy,f),SJ(c,function(l){l&&a.D.call()}),this.L.C(c));d=new aNd;L(d,1,1);c=new ZS;TPe(c,C(b.H,2));Oj(c,5,d);b=XZe(this.F,FI(this.D));EV(b,c);b=Dz(zz(yz(new xz,10),b));this.V.C(a.jk(),b)};
m.PFb=function(a){var b=a.C,c=PV(b.H),d=OQf(c);this.J=ho(c);d=new s7e(d);SJ(d,function(e){e&&a.D.call();xOf(b,c)});this.L.C(d)};m.kWb=function(a){var b=AV(a.D),c=gNf(b,a.F,a.O),d=this.H,e=a.F;gTe(d.C);d.C.L=b;d.C.Ba=c;d.C.Da=e;qTe(d.C,!0,!0,!1);v_(this,a.jk());a.D.C!=FI(this.D)&&(c=NI(this.D,a.D.C))&&(c=UG(c),this.La.listen(c,"tb",this.EPa));a.L&&(xPf(this.C)&&xPf(this.C).hS(!0,!1,!0),a=this.C,b=[b],a.isVisible()&&(a.Ja.refresh(b),ePf(a)))};
function OQf(a){var b=a.gb();a=ho(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.tc(),a.rc(),a.Vc(),a.Wc(),7,!1);return 0<b.length?b[0]:null}m.arb=function(a){var b=a.Sa;DI(MI(this.D),b);v_(this,a.jk())};
m.dJb=function(a){var b=a.C;a=a.jk();if(b instanceof ZW||b instanceof J5e||b instanceof KOf)v_(this,a,void 0,void 0,b.BK());else{var c=dPf(this.C),d=new ZS,e=C(b.H,2);c=c.indexOf(b);L(d,1,c);TPe(d,e);e=new bk;EV(e,d);if(b instanceof JNf){(d=b.D)?(b=PQf(this,b,d),b=Pwd(b,d,d.Gl)):b=null;if(!b)return;Oj(e,39,b)}else if(b instanceof cOf){var f=b.H;c=new ZMd;if(b instanceof cOf)b=1;else throw Error("Unknown text analysis card type.");f=Pg(QV(f),20).slice(0,10);L(c,2,f||[]);L(c,1,b);Oj(d,3,c)}e=Dz(zz(yz(new xz,
10),e));this.V.C(a,e)}};m.yHb=function(){this.C.Qc()};function PQf(a,b,c){a=dPf(a.C).filter(function(f){return f instanceof JNf});var d=a.map(function(f){return f.De()}),e=a[0]&&C(a[0].J,29);return Nwd(c,a.indexOf(b),b.D&&b.D.Qe(),d,e)}
function v_(a,b,c,d,e){e=void 0===e?10:e;if(a.F){var f=N(N(wk(a.ma),gk,58),Isa,7);if(c||!f||f.gb()!=a.F.C||f.rc()!=a.F.rect.rc()||f.tc()!=a.F.rect.tc()||f.Wc()!=a.F.rect.Wc()||f.Vc()!=a.F.rect.Vc()){f=new gk;L(f,6,JQf());var h=WZe(a.F);Oj(f,7,h);c&&(c=Na()-a.xa,L(f,8,1E3*c),null!=a.C.Rb&&(c=Na()-a.C.Rb,L(f,10,1E3*c)));d&&VPe(f,d);d=new bk;hk(d,f);a.ma=Dz(yz(zz(new xz,d),e))}}a.V.C(b,a.ma)}function QQf(){IJ.apply(this,arguments)}t(QQf,IJ);m=QQf.prototype;m.jmb=function(){return OOf};m.Vkb=function(){return vPf};
m.Klb=function(){return yQf};m.Blb=function(){return qNf};m.Ukb=function(){return HQf};m.Okb=function(){return jNf};m.Dlb=function(){return SMf};MJ("assistant",QQf);
